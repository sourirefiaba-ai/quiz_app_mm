import random
# Flaskというライブラリを読み込む
from flask import Flask, render_template, request, redirect, url_for, session
from markupsafe import Markup, escape


# Flaskアプリのインスタンスを作成 	Flaskアプリの本体を作る
app = Flask(__name__)

app.secret_key = "super_secret_key"  # セッション用

@app.template_filter('nl2br')
def nl2br_filter(s):
    if s is None:
        return ""
    # 改行を <br> に置換して安全に返す
    return Markup(escape(s).replace("\n", "<br>\n"))

quiz_data = {
    "トピック 1: 企業構造とマスタデータ": [
        # 問題 1
        {
            "question": "以下のうち、品目マスタの購買許容値キーを更新するレベルはどれですか。",
            "choices": ["クライアント", "会社コード", "プラント", "購買組織"],
            "answer": "クライアント",
            "explanation": "購買許容値キーとは、品目マスタにおいて不足納入や過剰納入の許容範囲を定義するためのキーです。\nこのキーは、購買管理の初期値として設定され、すべての品目に共通の許容範囲を適用したい場合に使用されます。\nこの設定は、品目マスタの購買データに含まれる購買固有の情報ですが、更新されるレベルはクライアントレベルです。\nつまり、企業全体で共通のルールとして管理される項目であり、会社コードやプラントごとに個別に設定するものではありません。\n例えば、学校で「遅刻は5分までOK」というルールを全校共通で決めるようなもので、クラスごとに違うルールを持たせるのではなく、全体で統一するイメージです。",
        },

        # 問題 2
        {
            "question": "以下のうち、仕入先の取引先マスタレコードを更新する必要がある組織レベルはどれですか。（3つ選択）",
            "choices": ["購買組織", "プラント", "クライアント", "会社コード", "購買グループ"],
            "answer": ["購買組織", "クライアント", "会社コード"],
            "explanation": "仕入先の取引先マスタレコードは、ビジネスパートナとして登録され、3つのレベルで管理されます。\n一つ目は「一般データ」で、クライアントレベルに保存されます。これは住所や銀行情報など、企業全体で共通して使う情報です。\n二つ目は「会計データ」で、会社コードレベルに保存されます。これは支払条件や統制勘定など、財務処理に必要な情報です。\n三つ目は「購買データ」で、購買組織レベルに保存されます。これは発注通貨やインコタームズなど、購買業務に必要な情報です。\n例えば、仕入先を「取引先」として登録する際に、企業全体で使う情報（住所など）はクライアントレベル、支払いルールは会社ごとに設定（会社コードレベル）、発注条件は購買部門ごとに設定（購買組織レベル）するイメージです。",        
        },

        # 問題 3
        {
            "question": "以下のうち、企業構造のカスタマイジングで実行できる購買組織割当はどれですか。（3つ選択）",
            "choices":["1つの購買組織を複数の会社コードに割り当てる", "複数の購買組織を1つの購買グループに割り当てる", "1つの購買組織を1つの会社コードに割り当てる", "複数の購買組織を1つの会社コードに割り当てる", "1つの購買組織を複数の会社コードにわたる複数のプラントに割り当てる"],
            "answer": [ "1つの購買組織を1つの会社コードに割り当てる", "複数の購買組織を1つの会社コードに割り当てる", "1つの購買組織を複数の会社コードにわたる複数のプラントに割り当てる" ],
            "explanation": "購買組織は、企業の購買活動を担当するロジスティクス上の組織単位であり、会社構造に応じて柔軟に割り当てることができます。\n一つ目は、購買組織を1つの会社コードに割り当てる方法です。これは会社ごとに購買部門を持つ構成で、会社内のプラントに対して購買活動を行います。\n二つ目は、複数の購買組織を1つの会社コードに割り当てる方法です。これは会社内で購買部門を分けて運用する構成で、部門ごとに異なる購買条件を設定できます。\n三つ目は、1つの購買組織を複数の会社コードにわたる複数のプラントに割り当てる方法です。これは会社間で共通の購買部門を持つ構成で、集中購買や戦略購買に適しています。\n例えば、全国に支店を持つ企業が「本社購買部」で全支店の仕入れを一括管理するようなイメージです。",
        },

        # 問題 4
        {
            "question": "以下のうち、調達の組織構造の特徴はどれですか。（2つ選択）",
            "choices": [
                "複数の保管場所を1つのプラントに割り当てることができる",
                "1つのプラントを複数のクライアントに割り当てることができる",
                "1つのプラントは1つの会社コードにのみ属することができる",
                "保管場所キーは会社コード内で一意である必要がある"
            ],
            "answer": [
                "複数の保管場所を1つのプラントに割り当てることができる",
                "1つのプラントは1つの会社コードにのみ属することができる"
            ],
            "explanation": "調達に関する組織構造では、会社コード・プラント・保管場所の関係が重要です。\n一つ目は、1つのプラントに複数の保管場所を割り当てることができる点です。これは、同じ工場内に複数の倉庫や棚卸区分があるようなイメージです。\n二つ目は、1つのプラントは1つの会社コードにのみ属するという点です。つまり、同じプラントを複数の会社で共有することはできません。\n例えば、1つの工場（プラント）が「A社専用」であり、その工場内に「原材料倉庫」「製品倉庫」など複数の保管場所がある構成を想像すると分かりやすいです。",
        },

        # 問題 5
        {
           "question": "購買組織の定義にあたって考慮が必要なことは何ですか。（2つ選択）",
           "choices": [
               "購買組織ごとに独自の品目マスタデータを持つこと",
               "購買組織ごとに独自の購買グループを持つこと",
               "購買組織ごとに独自の仕入先マスタデータを持つこと",
               "購買組織ごとに独自の購買情報を持つこと"
            ],
            "answer": [
               "購買組織ごとに独自の仕入先マスタデータを持つこと",
               "購買組織ごとに独自の購買情報を持つこと"
           ],
           "explanation": "購買組織は、企業の購買活動を担当するロジスティクス上の組織単位であり、仕入先との取引条件や購買情報を管理します。\n一つ目は、購買組織ごとに独自の仕入先マスタデータを持つことです。これは、同じ仕入先でも購買組織ごとに異なる条件（支払方法や取引通貨など）を設定できることを意味します。\n二つ目は、購買組織ごとに独自の購買情報を持つことです。これは、品目ごとの価格や納期などの情報を購買組織単位で管理できることを意味します。\nなお、品目マスタの購買管理データはプラントレベルで管理されるため、購買組織ごとに持つわけではありません。また、購買グループは購買担当者を表すもので、購買組織に割り当てるものではありません。\n例えば、同じ文房具を買う場合でも「本社購買部」と「支店購買部」で価格や納期が違うように、購買組織ごとに仕入先や品目の情報を分けて管理するイメージです。",
        },
        
        
        # 問題 6
        
        {
           "question": "会社間共通購買組織の設定時に更新すべきではない組織割当はどれですか。",
           "choices": [
             "プラント - 購買組織",
             "参照購買組織 - 購買組織",
             "プラント - 購買グループ",
             "会社コード - 購買組織"
             ],
           "answer": "会社コード - 購買組織",
           "explanation": "会社間共通購買組織とは、複数の会社コードにまたがるプラントに対して、1つの購買組織が調達を担当する構成です。\nこの場合、購買組織は会社コードに割り当ててはいけません。会社コードに割り当ててしまうと、その会社コードに属するプラントしか購買組織に割り当てられなくなり、会社間共通の調達ができなくなります。\n一方で、プラントと購買組織の割当は必須であり、参照購買組織の設定や購買グループとの関係も調達業務に影響しますが、会社コードとの直接の割当は避ける必要があります。\n例えば、グループ全体で使う「本社購買部」が、特定の会社に紐づいてしまうと、他の会社の工場に対して発注できなくなるようなイメージです。",
        },
        

        # 問題 7
        {
            "question": "生産計画および原価積上を会社に導入する予定です。以下のうち、在庫評価に選択する必要がある組織レベルはどれですか。",	
            "choices": ["管理領域", "事業領域", "会社コード", "プラント"],	
            "answer": "プラント",	
            "explanation": "在庫評価は、品目の価値をどの組織単位で管理するかを決める設定です。\nSAPでは、評価エリアを「会社コードレベル」または「プラントレベル」で定義できますが、実際の生産計画や原価積上はプラント単位で行われるため、在庫評価もプラントレベルで設定するのが一般的です。\n一度設定した評価エリアは、システム稼働後に変更できないため、導入時に慎重な判断が必要です。\n例えば、工場ごとに製品の原価や在庫価値を管理したい場合、プラント単位で評価することで、工場ごとのコストや在庫状況を正確に把握できるイメージです。",	        
        },

        # 問題 8
        {
            "question": "以下のうち、取引先の項目属性を定義するために使用できる影響要員はどれですか。（3つ選択）",
            "choices": [
             "活動",
             "ビジネスパートナロール",
             "購買組織",
             "クライアント",
             "勘定グループ"
            ],
            "answer": [
                "活動",
                "ビジネスパートナロール",
                "クライアント"
            ],
            "explanation": "取引先（ビジネスパートナ）の項目属性とは、住所や支払条件などの入力項目に対して「表示のみ」「必須入力」「任意入力」などの制御を行う設定です。\nこの制御は、主に3つの影響要因によって決まります。\n一つ目は「活動（アクティビティ）」で、登録・変更・表示などの操作内容によって項目の制御が変わります。\n二つ目は「ビジネスパートナロール」で、仕入先・得意先・従業員などの役割に応じて必要な項目が異なります。\n三つ目は「クライアント」で、企業全体で共通する項目制御が適用されます。\n例えば、社員情報を登録する画面では「氏名」は必須入力、「電話番号」は任意入力のように、操作内容や役割によって入力項目のルールが変わるイメージです。",
            },
        

        # 問題 9
        {
            "question": "以下のうち、購買管理で取引先機能決定を有効化するための前提条件となるアクティビティはどれですか。",
            "choices": [
             "取引先決定表の関連する勘定グループへの割当",
             "伝票タイプ別使用可能取引先機能の定義",
             "取引先機能の関連する契約タイプへの割当",
             "勘定グループ別使用可能取引先機能の定義"
             ],
            "answer": "勘定グループ別使用可能取引先機能の定義",
            "explanation": "購買管理において、取引先機能決定を有効化するには、まず取引先機能を定義し、それを勘定グループに対して使用可能として割り当てる必要があります。\nこの設定により、どの勘定グループがどの取引先機能を使用できるかが決まり、購買伝票の登録時に正しい取引先が選択されるようになります。\n他の選択肢である契約タイプや伝票タイプへの割当は、取引先機能の使用に関する補足的な設定であり、前提条件ではありません。\n例えば、社員の役割に応じて「出張申請」「備品購入」などの機能を使い分けるように、取引先の種類（勘定グループ）によって使える機能を制限するイメージです。",
        },

        # 問題 10
        {
            "question": "品目が簡易サービス調達プロセスで使用されるかどうかを制御する品目タイプの項目は、以下のうちどれですか。",
            "choices": [
                "外部購買発注",
                "項目参照",
                "明細カテゴリグループ",
                "製品タイプグループ"
            ],
            "answer": "製品タイプグループ",
            "explanation": "簡易サービス調達では、サービス品目を使って発注処理を行います。\nこのとき、品目タイプがサービス品目として機能するかどうかは「製品タイプグループ」によって制御されます。\n製品タイプグループでは、品目タイプがサービス品目として使えるように定義されている必要があります。\nこの設定により、サービスマスタがなくても、SAP Fioriアプリなどでサービス入力シートを登録することが可能になります。\n例えば、社内で清掃サービスを依頼する際に、物品ではなく「サービス」として登録することで、発注書ではなく作業報告書ベースで処理できるイメージです。",
        },
        

        # 問題 11
        {
            "question": "品目元帳にはどのような特徴がありますか。（3つ選択）",
            "choices": [
                "SAP S/4HANA では必須である",
                "さまざまな通貨で品目を評価するために使用される",
                "管理領域ごとに有効化する必要がある",
                "品目評価のさまざまな価格を計算するために使用される",
                "標準原価の計算に使用される"
            ],
            "answer": [
                "SAP S/4HANA では必須である",
                "さまざまな通貨で品目を評価するために使用される",
                "品目評価のさまざまな価格を計算するために使用される"
            ],
            "explanation": "品目元帳は、SAP S/4HANAにおいて必須の機能であり、品目のトランザクションデータを収集・管理するための仕組みです。\n一つ目の特徴は、SAP S/4HANAでは品目元帳の使用が必須であることです。これにより、すべての品目評価が品目元帳を通じて行われます。\n二つ目は、複数通貨で品目を評価できる点です。これにより、グローバル企業が各国通貨で在庫評価を行うことが可能になります。\n三つ目は、品目評価においてさまざまな価格（移動平均価格、標準価格など）を計算できる点です。\n例えば、海外支店で仕入れた部品を「現地通貨」と「本社通貨」の両方で評価し、在庫価値を正確に把握するようなイメージです。",
        }
    ],

    "トピック 2: 供給元": [

        # 問題 12
        {
            "question": "購買部門で分納契約の使用に関心が持たれています。リリース発注登録プロファイルに関して購買部門と共有できる有効な情報は何ですか。（3つ選択）",
            "choices": [
                "リリース発注登録プロファイルでは納入日程登録の周期が制御される",
                "リリース発注登録プロファイルにより分納契約納入日程行の登録がトリガされる",
                "リリース発注登録プロファイルは仕入先マスタデータに入力できる",
                "リリース発注登録プロファイルは購買情報に入力できる",
                "リリース発注登録プロファイルでは納入日程の計画数量の集計が制御される"
            ],
            "answer": [
                "リリース発注登録プロファイルでは納入日程登録の周期が制御される",
                "リリース発注登録プロファイルは仕入先マスタデータに入力できる",
                "リリース発注登録プロファイルでは納入日程の計画数量の集計が制御される"
            ],
            "explanation": "分納契約を使用する際、リリース発注登録プロファイルは納入日程の管理において重要な役割を果たします。\n一つ目は、納入日程登録の周期（例：日次、週次など）を制御できる点です。これにより、仕入先への発注タイミングを調整できます。\n二つ目は、仕入先マスタデータにプロファイルを入力することで、該当プラントの契約明細に自動的に反映される点です。\n三つ目は、納入日程の計画数量の集計方法を制御できる点で、必要な数量を効率よく管理できます。\n例えば、毎週の納品スケジュールをExcelで手動管理する代わりに、システム側で「週次で○個ずつ納品」と自動で調整してくれるようなイメージです。",
        },
        

        # 問題 13
        {
            "question": "期間依存条件の使用を設定できる伝票は、以下のうちどれですか。（2つ選択）",
            "choices": [
                "基本契約",
                "購買発注",
                "見積",
                "分納契約"
            ],
            "answer": [
                "見積",
                "分納契約"
            ],
            "explanation": "期間依存条件とは、特定の期間に有効な価格や条件を設定する仕組みであり、伝票の種類によって使用できるかどうかが異なります。\n見積と分納契約では、期間依存条件区分を設定することで、価格スケールや数量に応じた価格設定などの条件を期間ごとに管理できます。\n一方、購買発注では常に期間非依存条件が使用されるため、期間依存条件は設定できません。\n例えば、定期的に仕入れる商品に対して「1月は100円、2月は90円」といった価格を設定したい場合、分納契約や見積で期間依存条件を使うことで、月ごとの価格を自動で適用できるイメージです。",
        },


        # 問題 14
        {
            "question": "分納契約（リリース伝票あり）の登録を制御する項目はどれですか。",
            "choices": [
                "契約タイプ",
                "JIT 納入日程区分",
                "登録プロファイル",
                "明細カテゴリ"
            ],
            "answer": "契約タイプ",
            "explanation": "分納契約（リリース伝票あり）を登録する際には、契約タイプが重要な制御要素となります。\nSAPの標準設定では、伝票タイプ「LPA」が分納契約用に用意されており、このタイプには「分納契約のリリース伝票区分」が設定されています。\nこの区分により、リリース伝票の発行が可能となり、納入日程や数量を仕入先に通知することができます。\n例えば、定期的に納品される部品を管理する場合、「LPA」という契約タイプを使うことで、毎月の納品スケジュールを自動で発行できるイメージです。",
        },
        
        # 問題 15
        {
            "question": "供給量割当を使用します。新規の仕入先を既存の供給量割当に組込みます。新規の仕入先が最初から供給量割当に組み込まれていたものとしてみなされるようにするには、どうすればよいですか。",
            "choices": [
                "供給元一覧をマニュアルで更新する",
                "割当基本数量をマニュアルで更新する",
                "供給量割当をマニュアルで更新する",
                "供給量割当数量をマニュアルで更新する"
                ],
            "answer": "割当基本数量をマニュアルで更新する",
            "explanation": "供給量割当では、複数の仕入先に対して所要量を分配するための割合（割当レート）を計算します。\n新規の仕入先を既存の割当に含める際、過去の実績がないため割当済数量がゼロとなり、割当レートが極端に低くなる可能性があります。\nこのような場合に「割当基本数量」をマニュアルで設定することで、あたかも過去に一定量が割り当てられていたかのように扱うことができ、均等な割当が可能になります。\n例えば、新しく契約した仕入先にも他の仕入先と同じように発注を分配したいとき、「過去にこのくらい発注していたことにする」ような初期値を設定するイメージです。",
        },
            
        # 問題 16
        
        {
            "question": "品目グループに対して契約明細を登録します。この品目グループに属する特定の品目はこの契約明細を参照して発注されないようにする必要があります。これを行うにはどのようにすればよいですか。",
            "choices": [
                "仕入先に対して品目固有の供給元一覧を登録し、ブロック済区分を設定する",
                "契約明細に対して品目固有の供給元一覧を登録し、除外区分を設定する",
                "契約の有効期間外で仕入先に対して品目固有の供給元一覧を登録する",
                "契約明細に対して品目固有の供給元一覧を登録し、固定区分を設定する"
                ],
            "answer": "契約明細に対して品目固有の供給元一覧を登録し、除外区分を設定する",
            "explanation": "品目グループに対する契約明細では、グループに属する複数の品目が対象となりますが、特定の品目を契約の対象外にしたい場合は、供給元一覧に除外区分を設定する必要があります。\nこの設定により、該当する品目は契約明細を参照して発注されなくなります。\n除外区分は契約明細単位で品目ごとに登録でき、契約の有効期間とともに管理されます。\n例えば、文房具全体を契約対象としつつ「ホッチキスだけは別契約で管理したい」といった場合に、ホッチキスを除外区分で指定することで契約から外すイメージです。",
        },

        
        # 問題 17
        {
            "question": "以下のうち、集中契約を使用する場合に当てはまるものはどれですか。（2つ選択）",
            "choices": [
                "集中契約ではプラント固有の条件を更新できる",
                "集中契約ではプラントを指定できない",
                "集中契約はどの購買組織に対しても制限なしで使用できる",
                "集中契約は調達ハブシナリオで使用できる"
                ],
            "answer": [
                "集中契約ではプラント固有の条件を更新できる",
                "集中契約ではプラントを指定できない"
                ],
            "explanation": "集中契約とは、特定のプラントに依存しない契約であり、複数のプラントや購買組織にまたがって使用できる契約形態です。\n一つ目の特徴は、契約明細にプラントを指定しない点です。プラントはリリース発注時に初めて指定されます。\n二つ目は、集中契約でもプラント固有の条件（価格や納期など）を設定できる点です。これは、共通条件とは別に、プラントごとに異なる取引条件を管理できることを意味します。\nなお、集中契約は調達ハブシナリオでは使用されず、調達ハブでは中央購買契約が使用されます。\n例えば、全国の支店で使える共通契約を本社で一括管理しつつ、支店ごとに異なる価格や納期を設定できるようなイメージです。",
        },

        # 問題 18
        {
            "question": "分納契約の機能は以下のうちどれですか。（3つ選択）",
            "choices": [
                "分納契約は受託品 / 預託品管理に使用できる",
                "分納契約明細は常にプラント固有である",
                "分納契約では明細カテゴリ M（品目未選定）を使用できる",
                "分納契約では品目マスタレコードはオプションである",
                "納入日程行（分納契約）はマニュアルでのみ登録できる"
                ],
            "answer": [
                "分納契約は受託品 / 預託品管理に使用できる",
                "分納契約明細は常にプラント固有である",
                "分納契約では品目マスタレコードはオプションである"
                ],
            "explanation": "分納契約は、長期的な調達関係を前提に、仕入先とあらかじめ条件を定めて締結する契約です。\n一つ目の特徴は、受託品や預託品などの特殊な品目カテゴリにも対応できる点です。\n二つ目は、分納契約明細が必ずプラント（工場）単位で管理される点です。これは、納入日程や数量がプラントごとに異なるためです。\n三つ目は、品目マスタレコードがなくても契約明細を登録できる点です。つまり、まだ正式登録されていない品目でも契約に含めることが可能です。\nなお、明細カテゴリ M（品目未選定）は使用できず、納入日程行はMRP実行などで自動生成されるため、マニュアル登録のみという制限はありません。\n例えば、工場ごとに異なる納品スケジュールを持つ部品を、長期契約で管理しつつ、まだ正式登録されていない新製品も契約に含めるような運用が可能です。",
        }
    ],
    
    "トピック 3: 調達プロセス": [    

        # 問題 19
        {
            "question": "梱包に関する金額契約について仕入先と合意しました。正確な品目と購買価格はリリース発注まで指定されません。この契約の登録時に使用する必要がある明細カテゴリは、以下のうちどれですか。",
            "choices": [
                "W（品目グループ）",
                "M（品目未選定）",
                "B（制限）",
                "T（テキスト）"
                ],
            "answer": "M（品目未選定）",
            "explanation": "明細カテゴリ M（品目未選定）は、契約登録時に品目コードや価格を指定せず、後続のリリース発注で詳細を決定する場合に使用されます。\nこのカテゴリは、数量契約・金額契約の両方に対応しており、品目マスタが未登録でも利用可能です。\n一方、W（品目グループ）は価格が異なる品目群に対して使用されるため、今回のように価格未定の契約には適しません。\n例えば、梱包資材の契約で「段ボール・緩衝材・テープなどを必要に応じて発注するが、価格は都度決定する」といったケースでは、Mカテゴリが適切です。",
        },
        
        # 問題 20
        {
            "question": "すでに登録されている購買情報の条件を自動的に更新するには、どうすればよいですか。",
            "choices": [
                "契約リリース受注の登録時に購買情報更新区分を選択する",
                "契約の更新時に購買情報更新区分を選択する",
                "見積の更新時に購買情報更新区分を選択する",
                "購買発注の登録時に購買情報更新区分を選択する"
                ],
            "answer": "見積の更新時に購買情報更新区分を選択する",
            "explanation": "購買情報の条件（価格、追加料金、値引など）を自動的に更新するには、見積の更新時に「購買情報更新区分」を選択する必要があります。\nこの区分を選択することで、見積に含まれる条件が購買情報レコードに反映され、最新の価格や条件が自動で登録されます。\n契約や購買発注では、伝票番号や明細番号の更新は可能ですが、条件の更新は行われません。\n例えば、仕入先から新しい見積書が届いた際に、価格や送料などの条件を手動で入力する代わりに、見積更新時に更新区分を選択することで、システムが自動で購買情報を更新してくれるイメージです。",
        },
        
        # 問題 21
        {
            "question": "購買依頼明細または外部購買伝票明細では、勘定設定カテゴリによって何が制御されますか。（2つ選択）",
            "choices": [
                "設定する必要がある勘定設定オブジェクトのタイプ",
                "使用できる明細カテゴリ",
                "入庫を転記できるかどうか",
                "品目を入力する必要があるかどうか"
            ],
            "answer": [
                "設定する必要がある勘定設定オブジェクトのタイプ",
                "入庫を転記できるかどうか"
            ],
            "explanation": "勘定設定カテゴリは、消費品目などの調達時に、どのような会計処理が必要かを制御するための設定項目です。\n一つ目は「勘定設定オブジェクトのタイプ」で、原価センタや資産など、どの勘定オブジェクトを入力すべきかが決まります。\n二つ目は「入庫を転記できるかどうか」で、物品の受け取り（入庫）や請求書処理が必要かどうかを制御します。\nなお、「使用できる明細カテゴリ」は、勘定設定カテゴリによって制御されるのではなく、明細カテゴリに対して使用可能な勘定設定カテゴリを登録することで制御されるため、選択肢としては誤りです。\n例えば、社内用の備品を購入する際に「原価センタを指定し、入庫は不要」といった処理を勘定設定カテゴリで定義するイメージです。",
        },
        
        # 問題 22
        {
            "question_number": 22,
            "question": "２つのプラント間の在庫転送転記と比較して、在庫転送オーダーを利用する場合の利点は何ですか。（3つ選択）",
            "choices": [
                "品質検査中在庫から出庫できる",
                "配送費用を計画できる",
                "消費に入庫を転記できる",
                "MRP を使用して在庫転送オーダーを登録できる",
                "受託品への入庫を転記できる"
                ],
            "answer": [
                "配送費用を計画できる",
                "消費に入庫を転記できる",
                "MRP を使用して在庫転送オーダーを登録できる"
            ],
            "explanation": "在庫転送オーダーは、単なる在庫転送転記よりも高度な機能を持ち、以下のような利点があります。\n一つ目は「配送費用を計画できる」点で、運送業者や輸送コストを伝票に記録することが可能です。\n二つ目は「消費に入庫を転記できる」点で、転送先プラントで直接消費として処理することができます。\n三つ目は「MRPを使用して在庫転送オーダーを登録できる」点で、資材所要量計画（MRP）から直接転送オーダーを生成することができます。\n例えば、A工場からB工場へ部品を送る際に、MRPで必要数を計算し、配送費込みで転送オーダーを発行し、B工場ではそのまま生産に使うような流れが可能になります。",
        },

        # 問題 23
        {
            "question": "以下のうち、購買発注を参照して在庫に入庫を転記する場合、サポートされているアクションはどれですか。（3つ選択）",
            "choices": [
                "購買発注数量の一部に対する入庫を転記する",
                "入庫数量（在庫単位）の値を入力する",
                "入庫数量を複数の保管場所に分割する",
                "入庫数量を品質検査中在庫に転記する",
                "入庫数量に合わせて購買発注数量を調整する"
            ],
            "answer": [
                "購買発注数量の一部に対する入庫を転記する",
                "入庫数量を複数の保管場所に分割する",
                "入庫数量を品質検査中在庫に転記する"
                ],
            "explanation": "購買発注を参照して入庫処理を行う場合、以下のような柔軟な操作が可能です。\n一つ目は「発注数量の一部に対する入庫」で、納品が分割される場合などに対応できます。\n二つ目は「複数の保管場所への分割」で、1つの発注に対して複数のロケーションに品目を振り分けることができます。\n三つ目は「品質検査中在庫への転記」で、受け入れた品目をすぐに使用せず、検査工程に回すことができます。\nなお、「入庫数量に合わせて発注数量を調整する」ことはできず、発注数量は契約や見積に基づいて固定されているため、入庫はその範囲内で処理されます。\n例えば、100個発注したうち50個だけ納品された場合、50個を品質検査中在庫に振り分け、残りは後日別の保管場所に入庫するような運用が可能です。",
        },
        
        # 問題 24
        
        {
            "question": "仕入先受託品を使用する際は、何を実行する必要がありますか。（2つ選択）",
            "choices": [
                "受託品在庫払出の結果として生じた負債を決済する",
                "受託品購買情報を登録する",
                "受託品保管場所を登録する",
                "受託品入庫の結果として生じた負債を決済する"
            ],
            "answer": [
                "受託品在庫払出の結果として生じた負債を決済する",
                "受託品購買情報を登録する"
            ],
            "explanation": "受託品とは、仕入先から供給された品目が自社倉庫に保管されているが、所有権は仕入先にある状態を指します。\n債務が発生するのは入庫時ではなく、受託品を払い出した時点です。そのため、払出の結果として生じた負債を決済する必要があります。\nまた、受託品を管理するためには「受託品購買情報」の登録が必須です。これにより、仕入先や品目に紐づいた受託品管理が可能になります。\n一方で、受託品保管場所の登録や入庫時点での負債決済は必要ありません。\n例えば、仕入先から預かった部品を工場で使った瞬間に「仕入先に支払う義務」が発生し、その処理を購買情報と負債決済で管理するイメージです。",
        },

        # 問題 25
        {
            "question": "運用設備について、仕入先と清掃契約を締結しました。クレジットメモを毎月自動的に登録する月次契約について合意しました。このシナリオでは何を使用しますか。",
            "choices": [
                "ブランケット購買発注",
                "分納契約",
                "支払計画",
                "金額契約"
            ],
            "answer": "ブランケット購買発注",
            "explanation": "ブランケット購買発注は、低価格の品目やサービスを長期間にわたり効率的に調達するために使用されます。入庫やサービス入力は不要で、月次請求書などの一括請求に対応可能です。清掃契約や小規模修理などが典型的な例です。",
        },
        
        # 問題 26
        {
            "question": "購買発注を未転記にすると、どうなりますか。（2つ選択）",
            "choices": [
                "後続処理を使用して不完全伝票についてユーザに警告できる",
                "その伝票におけるあらゆる種類のエラーが許容される",
                "ワークフローを使用して伝票の完了を依頼できる",
                "その購買発注の追加転記が無効になる"
            ],
            "answer": [
                "ワークフローを使用して伝票の完了を依頼できる",
                "その購買発注の追加転記が無効になる"
                ],
            "explanation": "未転記機能を使うと、不完全な購買伝票を暫定保存できます。エラーがあっても許容されますが、在庫や購買管理上は完全な伝票が必要です。未転記状態では追加転記が無効化され、ワークフローを通じて他部門に伝票完了を依頼できます。",
        },
        
        # 問題 27
        {
            "question": "すでに納入された購買発注に対して仕入先請求書を入力します。購買発注以外に、何を参照として使用できますか。（2つ選択）",
            "choices": [
                "入出庫伝票",
                "入荷伝票",
                "納品書",
                "配送伝票"
                ],
            "answer": [
                "納品書",
                "配送伝票"
                ],
            "explanation": "仕入先請求書入力では、購買発注以外に納品書や配送伝票（船荷証券）を参照できます。これにより、請求書と納品・配送情報を照合し、正確な請求処理が可能になります。",
        },


        # 問題 28
        {
            "question": "外注調達プロセスの機能は次のうちどれですか。（3つ選択）",
            "choices": [
                "MRP によって外注購買依頼が登録されるようにできる",
                "外注発注明細の非評価品目入庫を転記できる",
                "外注明細カテゴリの制御パラメータをカスタマイズできる",
                "BOM に記載されている構成品目を更新できる",
                "外注発注明細を勘定に割り当てることができる"
            ],
            "answer": [
                "MRP によって外注購買依頼が登録されるようにできる",
                "BOM に記載されている構成品目を更新できる",
                "外注発注明細を勘定に割り当てることができる"
            ],
            "explanation": "外注調達では、外注先に最終製品を発注し、構成品目を支給します。MRPから外注購買依頼を生成でき、BOMから構成品目をコピー・更新可能です。また、外注発注明細は勘定に割り当てられ、消費や請求処理に対応します。非評価入庫やカテゴリテーブルのカスタマイズは不可です。",
        },

        
        
        
        
        # 問題 29
        {
            "question": "以下のうち、外注プロセスに含めることができるステップはどれですか。（3つ選択）",
            "choices": [
                "構成品目消費の後続調整を転記する",
                "外注先への直接納入対象の構成品目を調達する",
                "支給される構成品目の出荷伝票を登録する",
                "支給される構成品目の受注を登録する",
                "消費された構成品目を外注先に請求する"
            ],
            "answer": [
                "構成品目消費の後続調整を転記する",
                "外注先への直接納入対象の構成品目を調達する",
                "支給される構成品目の出荷伝票を登録する"
            ],
            "explanation": "外注プロセスでは、外注先に最終製品を発注すると同時に、製造に必要な構成品目を支給する必要があります。\nこの際、構成品目の出荷伝票を登録して外注先に供給し、必要に応じて別の仕入先から直接外注先へ納入させることも可能です。\nさらに、入庫後に外注先から報告される超過消費や過少消費に対応するため、後続調整を転記して在庫や消費数量を修正できます。\n一方で、受注登録や外注先への請求は外注プロセスには含まれません。\n例えば、外注先に部品を支給して製品を加工してもらい、その後入庫時に消費数量を調整する、といった流れが典型的な外注プロセスです。",
        },

        # 問題 30
        {
            "question": "年度中に発生する可能性があるいくつかの軽微な修理に対してブランケット購買発注を登録します。以下のうち、入力する必要があるデータはどれですか。（2つ選択）",
            "choices": [
                "全体制限値",
                "正味価格",
                "支払計画タイプ",
                "勘定設定カテゴリ"
            ],
            "answer": [
                "全体制限値",
                "勘定設定カテゴリ"
            ],
            "explanation": "ブランケット購買発注では、伝票タイプ FO を使用し、明細カテゴリ B（制限）と勘定設定カテゴリを入力する必要があります。\nこれにより制限値タブが表示され、全体制限値を入力できます。\n正味価格は見込み金額を指定すると自動採用されるため、手動入力は不要です。",
            },
    ],
    
    "トピック 4: ソーシングおよび調達における分析": [    
        
        # 問題 31
        {
            "question": "購買分析で主要業績指標 (KPI) レポートを分析するときにチャートで使用できるオプションにはどのようなものがありますか。（2つ選択）",
            "choices": [
                "スプレッドシートにエクスポートする",
                "表示される次元を変更する",
                "使用する CDS ビューを選択する",
                "スプレッドシートからインポートする"
            ],
            "answer": [
                "スプレッドシートにエクスポートする",
                "表示される次元を変更する"
            ],
            "explanation": "Smart Business KPI アプリでは、チャートビューや表形式ビューでディメンションとメジャーを表示できます。\nチャートの次元を変更したり、スプレッドシートにエクスポートする機能が提供されています。",
            },
        
        # 問題 32
        {
            "question": "調達概要アプリをパーソナライズするにはどうすればよいですか。（3つ選択）",
            "choices": [
                "ドラッグ&ドロップ機能を使用してカードを再配置する",
                "特定の仕入先に従ってカードの内容をフィルタリングする",
                "ユーザ設定を使用して、表示するカードと非表示にするカードを定義する",
                "同じ CDS ビューによってアクセスされる別のカードとカードを交換する",
                "独自のレイアウトを定義し、SAP Fiori ラウンチパッドにタイルとして保存する"
            ],
            "answer": [
                "ドラッグ&ドロップ機能を使用してカードを再配置する",
                "特定の仕入先に従ってカードの内容をフィルタリングする",
                "ユーザ設定を使用して、表示するカードと非表示にするカードを定義する"
                ],
            "explanation": "SAP Fiori 調達概要アプリでは、カードの配置変更、表示/非表示の切替、仕入先や品目グループに基づくフィルタリングが可能です。\nこれによりユーザは自分に最適なビューを構築できます。",
            },
        
        # 問題 33
        {
            "question": "既存の基本契約が使用されていた可能性があっても契約参照のない購買発注の支出を特定したいと考えています。この情報を提供する主要業績指標 (KPI) は、以下のうちどれですか。",
            "choices": [
                "契約外",
                "購買発注金額",
                "契約外支出",
                "未使用基本契約"
            ],
            "answer": "契約外",
            "explanation": "SAP Smart Business の契約関連KPIの一つである「契約外」は、契約参照のない購買発注の支出を特定できます。\nこれにより既存契約が利用されていない購買を把握できます。",
            },
        
        # 問題 34
        {
            "question": "購買依頼に対して利用可能な SAP Smart Business の主要業績指標 (KPI) にはどのようなものがありますか。（3つ選択）",
            "choices": [
                "購買依頼タッチレート",
                "購買依頼の平均承認時間",
                "購買依頼平均購買金額",
                "購買依頼から発注周期時間",
                "期日超過購買依頼"
            ],
            "answer": [
                "購買依頼タッチレート",
                "購買依頼の平均承認時間",
                "購買依頼から発注周期時間"
            ],
            "explanation": "購買依頼に関するKPIには、平均承認時間、発注周期時間、タッチレート（非タッチ率を含む）が提供されます。\nこれにより承認プロセスの効率や自動処理率を分析できます。",
        },
        
        
        # 問題 35
        {
            "question": "購買分析に使用される SAP Smart Business の主要業績指標 (KPI) タイルの主な機能にはどのようなものがありますか。（2つ選択）",
            "choices": [
                "タイルが変更されると、データベースがリアルタイムで更新される",
                "分析とアクションではドリルダウン機能と適切なリアクションが提供される",
                "異なる間隔でタイル表示を更新するためのスマートアラートしきい値を設定できる",
                "スマートフィルタやスマートチャートなどスマートコントロールを使用できる"
            ],
            "answer": [
                "分析とアクションではドリルダウン機能と適切なリアクションが提供される",
                "スマートフィルタやスマートチャートなどスマートコントロールを使用できる"
            ],
            "explanation": "KPIタイルは、クリックすると詳細分析画面に移動し、ドリルダウンやアクションが可能です。\nまた、スマートフィルタやスマートチャートなどの便利なUI要素も利用できます。\n例えば、購買額のKPIタイルを押すと、月別推移や担当別の詳細をすぐに確認できます。",
        },

        # 問題 36
        {
            "question": "SAP Fiori アプリ、購買グループ活動分析では、どのような情報を提供できますか。（2つ選択）",
            "choices": [
                "購買グループおよび今年度の月ごとの正味購買額",
                "今年度の始めから購買グループによって登録された契約の数",
                "今年度の始めからユーザによって登録された購買発注の数",
                "購買グループおよび今年度の月ごとの品質検査ロットの数"
            ],
            "answer": [
                "購買グループおよび今年度の月ごとの正味購買額",
                "今年度の始めから購買グループによって登録された契約の数"
            ],
            "explanation": "購買グループ活動分析アプリでは、購買グループごとの契約数や正味購買額を月単位で確認できます。\n発注数や品質検査ロット数は対象外です。\n例えば、購買グループAが今年どれだけ契約を締結したかを簡単に把握できます。",
        },

        # 問題 37
        {
            "question": "処理中にマニュアル介入が必要なすべての購買依頼明細の割合 (%) を分析するために使用できる調達概要アプリのカードは、以下のうちどれですか。",
            "choices": [
                "購買依頼明細監視",
                "購買依頼タッチレート",
                "購買依頼明細タイプ",
                "管理対象外支出"
            ],
            "answer": "購買依頼タッチレート",
            "explanation": "購買依頼タッチレートは、どれだけの購買依頼が手作業（高タッチ）を必要としているかを示す指標です。\nドーナツチャートで割合を視覚的に確認でき、詳細分析にも進めます。\n例えば、自動処理率が低い部署を特定するのに役立ちます。",
        },
        
    ],
    
    "トピック 5: 消費主導型所要量計画": [    

        # 問題 38
        {
            "question": "プラント内でそれぞれの品目を別に計画するために登録できるものは何ですか。",
            "choices": [
                "仕入先受託品購買情報",
                "供給場所",
                "棚番",
                "MRP エリア"
            ],
            "answer": "MRP エリア",
            "explanation": "MRPエリアは、プラント全体ではなく特定の領域ごとに品目計画を分けたいときに使う組織単位です。\n例えば、同じプラント内でも倉庫Aと倉庫Bで別々に計画したい場合にMRPエリアを設定します。",
        },

        # 問題 39
        {
            "question": "プラントの資材所要量計画 (MRP) を実行するための前提条件は何ですか。（2つ選択）",
            "choices": [
                "カスタマイジングで対応するプラントの各保管場所を MRP エリアに割り当てる",
                "自動的に計画される品目の品目マスタレコード MRP データを更新する",
                "カスタマイジングで対応するプラントのプラントパラメータを更新する",
                "プラントの品目の計画独立所要量を更新する"
            ],
            "answer": [
                "自動的に計画される品目の品目マスタレコード MRP データを更新する",
                "カスタマイジングで対応するプラントのプラントパラメータを更新する"
            ],
            "explanation": "MRPを正しく動かすには、品目マスタのMRPデータ（MRPタイプ、ロットサイズなど）と、プラントのMRPパラメータ（計画方法や例外処理など）を設定しておく必要があります。\n例えば、品目にMRPタイプが未設定だと、MRP実行時にその品目が計画対象になりません。",
        },

        # 問題 40
        {
            "question": "丸めプロファイルはどこで入力できますか。（2つ選択）",
            "choices": [
                "品目マスタ",
                "ロットまとめ方式",
                "購買情報",
                "供給元一覧"
            ],
            "answer": [
                "品目マスタ",
                "購買情報"
            ],
            "explanation": "丸めプロファイルは、数量をどの単位で丸めるかを決める設定です。\n品目マスタに設定するとMRP計画に反映され、購買情報に設定すると購買依頼や発注時の数量に反映されます。\n例えば、10個単位でしか発注できない品目なら、丸めプロファイルで10単位に丸めるよう設定します。",
        },
        
        # 問題 41
        {
            "question": "以下のうち、外部調達品目の MRP Live 計画実行時に登録できる調達提案はどれですか。（2つ選択）",
            "choices": ["購買依頼", "計画手配", "納入日程行", "購買発注"],
            "answer": ["購買依頼", "納入日程行"],
            "explanation": "MRP Liveでは、納入日程が有効な外部調達品目には納入日程行が登録され、それ以外の外部調達品目には購買依頼が登録されます。計画手配は標準機能ではなく、BAdI実装による拡張でのみ可能です。",
        },

        # 問題 42
        {
            "question": "自動発注点方式で安全在庫を決定するために必要なデータはどれですか。（3つ選択）",
            "choices": ["保管経費コード", "補充リードタイム", "サービスレベル", "平均絶対偏差", "最小在庫レベルと最大在庫レベル"],
            "answer": ["補充リードタイム", "サービスレベル", "平均絶対偏差"],
            "explanation": "自動発注点方式では需要予測を基に安全在庫を計算します。\n補充リードタイム、サービスレベル、平均絶対偏差が必要データです。",
        },

        # 問題 43
        {
            "question": "SAP S/4HANAでは、ローレベルコードはどこに保存されますか。（2つ選択）",
            "choices": ["計画ファイル", "品目マスタ", "部品表/配合表", "製造バージョン"],
            "answer": ["計画ファイル", "品目マスタ"],
            "explanation": "ローレベルコードは品目がBOMに表示される最下位レベルを表し、品目マスタと計画ファイルに保存されます。",
        },

        # 問題 44
        {
            "question": "以下のうち、発注点方式時に実行されるタスクはどれですか。（2つ選択）",
            "choices": [
                "正味所要量に含まれている品目ごとにロットサイズ計算を実行する",
                "逆日程計画を実行して購買依頼の利用可能日を設定する",
                "計画実行に含まれている品目ごとに正味所要量計算を実行する",
                "MRP関連の活動の対象となる品目にフラグを設定する"
            ],
            "answer": [
                "正味所要量に含まれている品目ごとにロットサイズ計算を実行する",
                "計画実行に含まれている品目ごとに正味所要量計算を実行する"
            ],
            "explanation": "発注点方式では在庫が発注点を下回ると正味所要量計算が行われ、ロットサイズ計算も実行されます。",
        },
        
    ],
    
    "トピック 6: 請求書照合": [    

        # 問題 45
        {
            "question": "以下のうち、どの状況で伝票保留を使用できますか。（2つ選択）",
            "choices": [
                "購買発注明細の勘定設定情報が不足している",
                "品質検査が必要な明細に対する入庫が転記される",
                "請求書明細の勘定設定情報が不足している",
                "差異を含むEDI請求書を受領する"
            ],
            "answer": ["請求書明細の勘定設定情報が不足している", "差異を含むEDI請求書を受領する"],
            "explanation": "請求書照合で必要情報が不足している場合や差異を含むEDI請求書を受領した場合に伝票保留が使用されます。",
        },
            
            
        # 問題 46
        {
            "question": "社内で、総転記方法を使用して現金割引額を含む請求書を転記しています。この場合、システムでは何が実行されますか。",
            "choices": [
                "現金割引額は現金割引決済勘定から在庫勘定または費用勘定に転記される",
                "現金割引額は現金割引決済勘定に転記され、支払時に消し込まれる",
                "現金割引額は在庫勘定または費用勘定に貸方転記される",
                "現金割引額は考慮されず、支払時に現金割引勘定にのみ転記される"
            ],
            "answer": "現金割引額は考慮されず、支払時に現金割引勘定にのみ転記される",
            "explanation": "総額転記では請求書転記時に現金割引額は考慮されず、支払時にのみ現金割引勘定に転記されます。",
        },

        # 問題 47
        {
            "question": "請求書の支払を保留するために使用できるオプションはどれですか。（3つ選択）",
            "choices": [
                "自動保留に対するプラント固有の許可範囲を設定する",
                "ユーザ権限に基づく自動保留を設定する",
                "無作為の自動保留を設定する",
                "請求書ヘッダレベルでマニュアル支払保留を設定する",
                "金額に基づく自動保留を設定する"
            ],
            "answer": [
                "無作為の自動保留を設定する",
                "請求書ヘッダレベルでマニュアル支払保留を設定する",
                "金額に基づく自動保留を設定する"
            ],
            "explanation": "請求書支払保留は金額差異やランダムチェック、マニュアル設定などで利用可能です。",
        },

        # 問題 48
        {
            "question": "請求書の明細に対して保留理由「品質」が設定されています。これはなぜでしょうか。（2つ選択）",
            "choices": [
                "入庫基準請求書照合が使用されておらず、購買発注明細の品質検査ロットが使用決定されていない",
                "入庫基準請求書照合が使用されておらず、品目マスタで請求書の明細に品質検査在庫への転記フラグが設定されている",
                "入庫基準請求書照合が使用されており、入庫の品質検査ロットが使用決定されていない",
                "入庫基準請求書照合が使用されており、請求書の明細に対して入庫が転記されていない"
            ],
            "answer": [
                "入庫基準請求書照合が使用されておらず、購買発注明細の品質検査ロットが使用決定されていない",
                "入庫基準請求書照合が使用されており、入庫の品質検査ロットが使用決定されていない"
            ],
            "explanation": "品質検査ロットが使用決定されていない場合や不合格の場合に請求書が保留されます。",
        },

        # 問題 49
        {
            "question": "購買発注基準請求書照合の主な機能にはどのようなものがありますか。（2つ選択）",
            "choices": [
                "未請求数量として合計納入済数量が自動的に提案される",
                "購買発注明細に対する分割納入は請求書伝票で個別明細として表示される",
                "購買発注明細に対する分割納入には個別請求書明細のフラグが設定されない",
                "合計納入済数量と合計請求済数量の差異として未請求数量が提案される"
            ],
            "answer": [
                "購買発注明細に対する分割納入には個別請求書明細のフラグが設定されない",
                "合計納入済数量と合計請求済数量の差異として未請求数量が提案される"
            ],
            "explanation": "購買発注基準請求書照合では分割納入は個別明細として扱われず、未請求数量は合計納入済数量と請求済数量の差異として提案されます。",
        },

        # 問題 50
        {
            "question": "入庫基準請求書照合の主な機能にはどのようなものがありますか。（３つ選択）",
            "choices": [
                "入庫ごとに請求書明細が自動生成される。",
                "前提条件として、入庫基準請求書照合が購買発注明細で設定されている。",
                "各請求書明細が入庫明細に割り当てられる。",
                "入庫の転記処理は請求書の転記より前に行う必要がある。",
                "転記後、入庫間で請求書を割り当て直すことができる。"
            ],
            "answer": [
                "前提条件として、入庫基準請求書照合が購買発注明細で設定されている。",
                "各請求書明細が入庫明細に割り当てられる。",
                "入庫の転記処理は請求書の転記より前に行う必要がある。"
            ],
            "explanation": "入庫基準請求書照合では、まず購買発注明細に「入庫基準請求書照合」の設定が必要です。また、請求書を登録するには少なくとも1件の入庫が転記されている必要があります。納入が分割されている場合は、入庫ごとに個別の請求書明細が自動生成され、各請求書明細は対応する入庫明細に割り当てられます。請求書数量は実際の納入数量を超えてはいけません。また、一度割り当てられた請求書明細は別の入庫に再割当できません。",
        },
            
                    
        # 問題 51
        {
            "question": "請求書差額処理を使用して請求書を転記します。システムでは何が実行されますか。（2つ選択）",
            "choices": [
                "請求書転記およびクレジットメモ転記の両方を含む会計伝票が１つのみ登録される",
                "仕入先がクレジットメモ受領を確認するまで請求書の支払が保留される",
                "クレジットメモ転記の通知として仕入先に発行できるメッセージが登録される",
                "２つの会計伝票が登録される（１つは請求書転記用、もう１つはクレジットメモ転記用）"
            ],
            "answer": [
                "クレジットメモ転記の通知として仕入先に発行できるメッセージが登録される",
                "２つの会計伝票が登録される（１つは請求書転記用、もう１つはクレジットメモ転記用）"
            ],
            "explanation": "請求書差額処理では、請求書金額と受入可能金額に差がある場合、その差額をクレジットメモとして処理します。その結果、請求書用とクレジットメモ用の2つの会計伝票が登録されます。また、仕入先に通知するためのクレジットメモ転記メッセージも生成されます。例えば、請求書が10万円で届いたが契約上は9万円しか認められない場合、差額1万円をクレジットメモとして処理し、仕入先へ通知できます。",
        },

        # 問題 52
        {
            "question": "入庫／請求仮勘定に未処理明細が存在する原因となる状況は、以下のうちどれですか。（2つ選択）",
            "choices": [
                "購買発注明細の発注済数量が納入済数量よりも多い",
                "購買発注明細の請求済数量が納入済数量よりも多い",
                "購買発注明細の発注済数量が請求済数量よりも多い",
                "購買発注明細の納入済数量が請求済数量よりも多い"
            ],
            "answer": [
                "購買発注明細の請求済数量が納入済数量よりも多い",
                "購買発注明細の納入済数量が請求済数量よりも多い"
            ],
            "explanation": "入庫／請求仮勘定は、納入済数量と請求済数量が一致したときに決済されます。そのため、どちらかが多い場合には差異が発生し、未処理明細として残ります。請求済数量が多い場合は追加の入庫が必要で、納入済数量が多い場合は追加の請求書が必要になります。例えば、80個納入されたのに100個分の請求が来た場合、20個分の差異が未処理として残ります。",
        },

        # 問題 53
        {
            "question": "請求書受領時に消費品目の勘定設定データを変更することを許可するパラメータはどこで設定できますか。",
            "choices": [
                "勘定設定カテゴリ",
                "購買発注伝票タイプ",
                "明細カテゴリ",
                "消費品目の品目マスタ"
            ],
            "answer": "勘定設定カテゴリ",
            "explanation": "消費品目や外部サービスの調達では、購買発注明細に勘定設定が必要です。請求書照合時に勘定設定データを変更できるかどうかは、勘定設定カテゴリの設定で制御されます。ここで変更が許可されていれば、請求書受領時に原価センタなどを修正できます。例えば、消耗品の請求書が届いた際に原価センタを別部署へ変更したい場合、勘定設定カテゴリで許可されていれば照合時に修正できます。",
        },
    ],
    
    "トピック 7: 在庫管理と実地棚卸": [    
        
        # 問題 54
        {
            "question": "新しい移動タイプを定義するときに設定できるものは何ですか。（3つ選択）",
            "choices": [
                "使用可能トランザクション",
                "項目選択",
                "動的利用可能在庫確認",
                "数量更新の数量ストリング",
                "勘定設定の金額転記ストリング"
            ],
            "answer": [
                "使用可能トランザクション",
                "項目選択",
                "動的利用可能在庫確認"
            ],
            "explanation": "移動タイプの定義では、在庫管理や業務処理に関わる複数の設定が可能です。\n「使用可能トランザクション」は、どのトランザクションコードでその移動タイプを使用できるかを定義します。\n「項目選択」は、伝票入力時に表示・入力可能な項目を制御します。\n「動的利用可能在庫確認」は、在庫の可用性をリアルタイムに判断するための設定です。\n一方、「数量ストリング」や「金額転記ストリング」はSAP標準で固定されており、変更や設定はできません。\n例えば、新しい移動タイプを定義して「返品処理専用」とした場合、返品時に必要な項目だけを表示するように項目選択を調整し、返品トランザクションに割り当てることで業務効率を高めることができます。",
        },

        # 問題 55
        {
            "question": "購買発注 (PO) 明細で納入完了区分を設定すると、どうなりますか。（2つ選択）",
            "choices": [
                "その購買発注明細は削除およびアーカイブできない",
                "納入督促状の生成時にその購買発注明細がスキップされる",
                "残数量の入庫を引き続き転記できる",
                "その購買発注明細の未確定債務が増加する"
            ],
            "answer": [
                "納入督促状の生成時にその購買発注明細がスキップされる",
                "残数量の入庫を引き続き転記できる"
            ],
            "explanation": "納入完了区分を設定すると、購買発注明細はクローズされたと見なされ、資材所要量計画（MRP）や納入督促の対象外になります。\nただし、残数量の入庫は引き続き転記可能であり、納入完了区分が設定されていても実際の入庫処理は可能です。\n一方、未確定債務は増加せず、むしろ取り消される方向に働きます。また、削除やアーカイブも可能です。\n例えば、90個納入済みで100個発注していた場合、納入完了区分を設定すれば、残り10個の督促は行われず、必要に応じて入庫だけは可能になります。",
        },

        # 問題 56
        {
            "question": "仕入先からの商品が倉庫に到着します。まだこれらの商品を在庫の一部にしたくありません。条件付きの入庫（GR）を記録するための手順はどれですか。",
            "choices": [
                "購買発注でメモを作成し、納入を受け入れる条件が満たされるまで待機する",
                "購買発注明細で仕入先構内での受領フラグを設定し、保留評価入庫に入庫を転記する",
                "入庫転記時に保留在庫タイプを選択する",
                "非評価入庫保留在庫に入庫を転記する"
            ],
            "answer": "非評価入庫保留在庫に入庫を転記する",
            "explanation": "条件付きで商品を受け入れる場合（例：証明書未到着など）、移動タイプ103を使用して「非評価入庫保留在庫」に転記するのが適切です。\nこの在庫はまだ評価されず、通常の在庫には含まれませんが、購買発注履歴には記録されます。\n会計伝票は発行されず、後続の評価入庫（移動タイプ105）によって正式な在庫として登録されます。\n例えば、納品された医療機器が検査証明書待ちの場合、103で保留在庫に入れておき、証明書到着後に105で評価入庫する流れが一般的です。",
        },
        
        # 問題 57
        {
            "question": "SAP S/4HANA で、同じ会社コード内の２つの異なるプラント間在庫転送用に提供されているさまざまなオプションをテストします。在庫転送オーダーに該当するのは、以下のうちどれですか。（2つ選択）",
            "choices": [
                "運送中の品目は入庫プラントの積送中在庫として管理される",
                "入庫プラントの保管在庫に入庫を転記できる",
                "出庫転記時に２つの会計伝票が登録される（プラントごとに１つずつ）",
                "供給プラントの検査在庫からの出庫を転記できる"
            ],
            "answer": [
                "運送中の品目は入庫プラントの積送中在庫として管理される",
                "入庫プラントの保管在庫に入庫を転記できる"
            ],
            "explanation": "在庫転送オーダーを使用したプラント間転送では、出庫後の品目は入庫プラント側で「積送中在庫」として管理されます。\nその後、入庫プラントで転記を行うことで、保管在庫に正式に入庫されます。\nこのプロセスにより、物流の途中段階もシステム上で可視化・管理可能になります。\n一方、出庫時に会計伝票が2つ登録されることはなく、検査在庫からの出庫も標準ではサポートされていません。\n例えば、AプラントからBプラントへ部品を送る際、出庫後はBプラントの積送中在庫として記録され、到着後に保管在庫へ転記される流れになります。",
        },

        # 問題 58
        {
            "question": "以下のうち、入庫時に品目の有効期限をシステムがチェックするために満たされている必要がある前提条件はどれですか。（2つ選択）",
            "choices": [
                "カスタマイジングで移動タイプに対して有効期限確認が有効化されていること",
                "購買発注明細に残存有効期間が含まれていること",
                "総有効期間が購買情報で更新されていること",
                "カスタマイジングで品目タイプに対して有効期限確認が有効化されていること"
            ],
            "answer": [
                "カスタマイジングで移動タイプに対して有効期限確認が有効化されていること",
                "購買発注明細に残存有効期間が含まれていること"
            ],
            "explanation": "入庫時に有効期限をチェックするには、まず「移動タイプに対して有効期限確認が有効化されている」必要があります。\n加えて、購買発注明細に「残存有効期間」が入力されていることが条件です。\nこれにより、システムは納入された品目の有効期限が要件を満たしているかどうかを判断できます。\n一方、「品目タイプに対する有効期限確認」や「購買情報での総有効期間更新」は、入庫時の有効期限チェックには直接関係しません。\n例えば、医薬品を受け入れる際に「最低6ヶ月の残存有効期間」が必要な場合、購買発注でその条件を設定し、入庫時にシステムが自動チェックする流れになります。",
        },

        # 問題 59
        {
            "question": "製造指図への出庫転記にはどのような特徴がありますか。（2つ選択）",
            "choices": [
                "出庫をバックフラッシュとして転記できる",
                "出庫の結果として入出庫予定が削除される",
                "出庫を計画出庫のみにすることができる",
                "実際原価が製造指図に割り当てられる"
            ],
            "answer": [
                "出庫をバックフラッシュとして転記できる",
                "実際原価が製造指図に割り当てられる"
            ],
            "explanation": "製造指図への出庫転記では、バックフラッシュ（自動出庫）を使用することで、製造完了時に構成品目の出庫を一括処理できます。\nまた、出庫時には実際原価が評価され、製造指図に割り当てられます。これにより、原価管理や会計処理が正確に行われます。\n一方、出庫によって入出庫予定が削除されるわけではなく、計画出庫のみに制限することもできません。\n例えば、製造指図に基づいて部品を出庫する際、バックフラッシュを使えば手動ピッキングなしで出庫が記録され、原価も自動的に製造指図に反映されます。",
        },

        # 問題 60
        {
            "question": "システムで対応する購買発注（PO）なしで入庫を転記しています。以下のうち、入庫時における購買発注自動生成の前提条件はどれですか。（3つ選択）",
            "choices": [
                "品目と仕入先の組合せに対して有効な購買情報が存在している",
                "移動タイプについて、カスタマイジングで購買発注自動生成が有効化されている",
                "入庫に対して既定設定カテゴリが指定されている",
                "入庫に対してデフォルト購買発注タイプが指定されている",
                "集中購買組織がカスタマイジングでプラントに割り当てられている"
            ],
            "answer": [
                "品目と仕入先の組合せに対して有効な購買情報が存在している",
                "移動タイプについて、カスタマイジングで購買発注自動生成が有効化されている",
                "入庫に対してデフォルト購買発注タイプが指定されている"
            ],
            "explanation": "購買発注なしで入庫を転記する場合でも、システムが自動的に購買発注を生成するには、いくつかの前提条件が必要です。\nまず、「品目と仕入先の組合せに対して有効な購買情報」が存在している必要があります。\n次に、「移動タイプに対して購買発注自動生成が有効化されている」ことがカスタマイジングで設定されている必要があります。\nさらに、「入庫に対してデフォルト購買発注タイプ」が指定されていることで、伝票タイプが自動的に割り当てられます。\n例えば、倉庫に納品された品目が事前に発注されていない場合でも、これらの条件が整っていれば、入庫時にシステムが自動的にPOを生成し、後続処理が可能になります。",
        },
        
        # 問題 61
        {
            "question": "以下の記述のうち、マニュアルで登録された入出庫予定に当てはまるものはどれですか。（2つ選択）",
            "choices": [
                "明細ごとに異なる勘定設定オブジェクトを割り当てることができる",
                "明細ごとに異なる移動タイプを更新できる",
                "明細ごとに移動可能区分を設定できる",
                "明細に品目コードを入力する必要がある"
            ],
            "answer": [
                "明細ごとに移動可能区分を設定できる",
                "明細に品目コードを入力する必要がある"
            ],
            "explanation": "入出庫予定は、将来の在庫移動（主に払出）に備えて品目を準備するための機能です。\nマニュアル登録された入出庫予定では、明細ごとに「移動可能区分」を設定することができ、また「品目コード」の入力が必須です。\n一方、勘定設定オブジェクトや移動タイプはヘッダレベルで管理されるため、明細ごとに異なる設定はできません。\n例えば、複数の品目を異なる保管場所に出庫予定として登録する際、それぞれの品目に対して移動可能区分を設定し、品目コードを入力することで、倉庫作業の準備がスムーズに行えます。",
        },

        # 問題 62
        {
            "question": "SAP S/4HANA で、品目の在庫の初期エントリをマニュアルで転記する必要があります。数量と金額の両方を入力する必要があります。どうすればよいですか。（2つ選択）",
            "choices": [
                "SAP Fiori ラウンチパッドで、在庫管理アプリを使用する",
                "SAP Fiori ラウンチパッドで、参照なしの入庫転記アプリを使用する",
                "SAP Fiori ラウンチパッドで、在庫移動の転記アプリを使用する",
                "SAPGUI で、トランザクション MIGO を使用する"
            ],
            "answer": [
                "SAP Fiori ラウンチパッドで、在庫移動の転記アプリを使用する",
                "SAPGUI で、トランザクション MIGO を使用する"
            ],
            "explanation": "SAP S/4HANAで在庫の初期エントリ（初期化）を行うには、数量と金額の両方を入力できる機能が必要です。\n「在庫移動の転記」アプリと「トランザクション MIGO」は、参照なしの入庫や初期在庫の登録に対応しており、評価額の入力も可能です。\n一方、「在庫管理アプリ」や「参照なしの入庫転記アプリ」は、金額入力に対応していないか、初期化目的には適していません。\n例えば、旧システムから移行した在庫をSAPに登録する際、MIGOで数量と金額を入力すれば、評価在庫として正しく反映されます。",
        },

        # 問題 63
        {
            "question": "在庫管理で品目に対して在庫決定方針を使用するための前提条件は何ですか。（3つ選択）",
            "choices": [
                "カスタマイジングで品目タイプに在庫決定方針を割り当てる",
                "在庫決定に対するクロスアプリケーションの方針をカスタマイズする",
                "品目マスタレコードに在庫決定グループを割り当てる",
                "カスタマイジングで業務トランザクションに在庫決定規則を割り当てる",
                "在庫決定規則をカスタマイズして保管域タイプに割り当てる"
            ],
            "answer": [
                "在庫決定に対するクロスアプリケーションの方針をカスタマイズする",
                "品目マスタレコードに在庫決定グループを割り当てる",
                "カスタマイジングで業務トランザクションに在庫決定規則を割り当てる"
            ],
            "explanation": "在庫決定方針を使用するには、以下の3つの設定が必要です。\nまず、在庫決定に対するクロスアプリケーションの方針をカスタマイズし、方針ごとに在庫決定グループと規則を定義します。\n次に、品目マスタレコードに在庫決定グループを割り当てることで、品目ごとの方針適用が可能になります。\n最後に、業務トランザクション（例：移動タイプ）に在庫決定規則を割り当てることで、実際の在庫移動時に方針が適用されます。\n例えば、複数の保管場所から最適な在庫を自動選定するには、これらの設定が整っている必要があります。",
        },
        
        # 問題 64
        {
            "question": "実地棚卸伝票ヘッダに帳簿在庫凍結区分を設定すると、どんな効果がありますか。",
            "choices": [
                "調達用に実地棚卸伝票の在庫管理ユニットがすべて保留にされる",
                "検数開始時に実地棚卸伝票で帳簿在庫が設定および固定される",
                "在庫移動の実地棚卸伝票の在庫管理ユニットがすべて保留にされる",
                "差異転記時に実地棚卸伝票で帳簿在庫が設定および固定される"
            ],
            "answer": "検数開始時に実地棚卸伝票で帳簿在庫が設定および固定される",
            "explanation": "帳簿在庫凍結区分を設定すると、検数開始時点で帳簿在庫が固定され、以降の在庫移動による数量変更が棚卸処理に影響しないようになります。\nこれは、棚卸期間中の在庫変動を防ぎ、正確な差異分析を行うための重要な設定です。\n例えば、棚卸作業中に別の部署が在庫移動を行った場合でも、凍結された帳簿在庫に基づいて差異が計算されるため、棚卸の整合性が保たれます。",
        },
        
    ],  
 
   "トピック 8: 評価と勘定設定": [
        
        # 問題 65
        {
            "question": "原材料（品目タイプ ROH）と消耗品（品目タイプ HIBE）に対して同じ勘定設定を設定する必要があります。これらの品目タイプをグループ化するにはどうすればよいですか。",
            "choices": [
                "同じ評価グループコードを品目タイプに割り当てる",
                "同じ勘定修正キーを品目タイプに割り当てる",
                "同じ参照勘定カテゴリを品目タイプに割り当てる",
                "同じ評価クラスを品目タイプに割り当てる"
            ],
            "answer": "同じ参照勘定カテゴリを品目タイプに割り当てる",
            "explanation": "SAPでは、勘定設定は評価クラスに対して割り当てられますが、複数の品目タイプに同じ評価クラスを適用するためには、共通の参照勘定カテゴリを割り当てる必要があります。\nこの参照勘定カテゴリが、品目タイプと評価クラスの関係を橋渡しする役割を果たします。\n例えば、ROHとHIBEの両方に「原材料用評価クラス1000」を使いたい場合、それぞれに同じ参照勘定カテゴリ（例：RM）を設定することで、同一の勘定設定が適用可能になります。",
        },

        # 問題 66
        {
            "question": "改修プロセスで品目分割評価を使用し、品目の条件に基づいて品目を区別する必要があります。品目の会計データについて、何を考慮する必要がありますか。",
            "choices": [
                "評価エリアでは、原価管理が標準原価である必要がある",
                "使用可能な評価タイプごとに、原価管理が標準原価である必要がある",
                "使用可能な評価タイプごとに、原価管理が移動平均原価である必要がある",
                "評価エリアでは、原価管理が移動平均原価である必要がある"
            ],
            "answer": "評価エリアでは、原価管理が移動平均原価である必要がある",
            "explanation": "品目分割評価では、同一品目でも条件（品質、調達方法など）に応じて異なる評価を行うため、評価エリア単位での原価管理が重要になります。\nこのとき、評価エリアでは「移動平均原価（V）」が必要です。これにより、品目の部分在庫ごとに異なる原価を柔軟に管理できます。\n一方、評価タイプごとの原価管理は任意であり、標準原価や移動平均原価の選択が可能です。\n例えば、同じ部品でも外部調達品と社内製造品で原価が異なる場合、それぞれを分割評価し、移動平均原価で管理することで、より正確な原価計算が可能になります。",
        },

        # 問題 67
        {
            "question": "品目分割評価を実装するには、何を行う必要がありますか。（2つ選択）",
            "choices": [
                "評価タイプを在庫タイプに割り当てる",
                "評価カテゴリと評価タイプをカスタマイズする",
                "評価タイプをすべての未処理購買発注明細に追加する",
                "関連品目の追加会計データを登録する"
            ],
            "answer": [
                "評価カテゴリと評価タイプをカスタマイズする",
                "関連品目の追加会計データを登録する"
            ],
            "explanation": "品目分割評価を実装するには、まず評価カテゴリと評価タイプを定義・カスタマイズし、それらを適切に割り当てる必要があります。\nさらに、分割評価を適用する品目に対して、評価タイプごとの追加会計データ（評価クラスや原価管理など）を登録することが必要です。\nこれにより、同一品目でも調達方法や品質などの条件に応じて異なる評価が可能になります。\n例えば、内製品と外部調達品で原価が異なる場合、それぞれに評価タイプを設定し、会計データを分けることで、より精緻な原価管理が実現できます。",
        },

        # 問題 68
        {
            "question": "購買発注参照のある請求書を登録するときに、自動予定外配送費用の転記に利用できるオプションは以下のうちどれですか。（2つ選択）",
            "choices": [
                "費用を各請求書明細に配賦できる",
                "費用を別の勘定に転記できる",
                "費用は別の請求書に自動的に転記される",
                "費用を転記するための運賃決済勘定が設定される"
            ],
            "answer": [
                "費用を各請求書明細に配賦できる",
                "費用を別の勘定に転記できる"
            ],
            "explanation": "予定外配送費用は、購買発注で事前に合意されていない費用であり、請求書登録時に初めて入力されます。\nこの費用は、カスタマイジング設定により「各請求書明細に比例配賦」するか、「個別のG/L勘定に転記」するかを選択できます。\n例えば、配送費用が1万円で、請求書明細が複数ある場合、配賦設定が有効なら各明細に分配され、転記設定が有効なら運賃用の勘定に一括転記されます。\n一方、「別の請求書への自動転記」や「運賃決済勘定の設定」は、転記の直接手段ではなく、補助的な設定や誤解を招く表現です。",
        },
        
        # 問題 69
        {
            "question": "廃棄費用を特別勘定に転記しようとしています。勘定設定の動作を制御するために使用できる特性はどれですか。（2つ選択）",
            "choices": [
                "プラント",
                "在庫タイプ",
                "移動タイプ",
                "保管場所"
            ],
            "answer": [
                "プラント",
                "移動タイプ"
            ],
            "explanation": "SAPの自動勘定設定では、在庫移動や請求書照合などのトランザクションに対して、G/L勘定への転記を制御するためにいくつかの特性が使用されます。\nその中でも「プラント」は会社コードや評価エリアを特定するために使用され、「移動タイプ」は在庫移動の性質（入庫・出庫・転送など）を区別するために重要です。\n一方、「在庫タイプ」や「保管場所」は勘定設定のキーとしては使用されません。\n例えば、廃棄処理を行う際、移動タイプとして「廃棄用」を選択し、プラントに応じた評価エリアの設定により、廃棄費用を特定のG/L勘定に自動転記することが可能になります。",
        },

        # 問題 70
        {
            "question": "自動勘定設定が不適切に設定されている場合にエラーメッセージが表示されるトランザクションは、以下のうちどれですか。（3つ選択）",
            "choices": [
                "在庫タイプ間の振替転記",
                "会社コード間の在庫転送",
                "品目価格変更",
                "保留在庫への入庫",
                "購買情報価格の変更"
            ],
            "answer": [
                "会社コード間の在庫転送",
                "品目価格変更",
                "保留在庫への入庫"
            ],
            "explanation": "自動勘定設定が不適切な場合、会計伝票が生成されるトランザクションでエラーが発生します。\n「会社コード間の在庫転送」は法的会計単位をまたぐため、必ず会計伝票が必要です。\n「品目価格変更」は在庫が存在する場合に再評価が発生し、会計伝票が生成されます。\n「保留在庫への入庫」も会計上の在庫増加として扱われるため、会計伝票が必要です。\n一方、「在庫タイプ間の振替転記」は会計伝票を伴わず、「購買情報価格の変更」は会計取引ではないため、エラーにはなりません。\n例えば、会社コードAからBへ部品を転送する際、勘定設定が未定義だと転記時にエラーが表示されます。",
        },

        # 問題 71
        {
            "question": "条件タイプに基づいて予定配送費用の勘定設定を制御するには、どうすればよいですか。",
            "choices": [
                "検索順序で勘定キーを割り当てる",
                "条件タイプで勘定キーを割り当てる",
                "価格決定表で勘定キーを割り当てる",
                "条件レコードで勘定キーを割り当てる"
            ],
            "answer": "価格決定表で勘定キーを割り当てる",
            "explanation": "予定配送費用の勘定設定は、購買管理の価格決定表に基づいて制御されます。\n価格決定表では、条件タイプごとに勘定キー（内部処理キー）を割り当てることができ、これにより配送費用を消込勘定や引当勘定などに自動転記することが可能になります。\n例えば、配送条件タイプ「FRA1」に対して勘定キー「UPF」を割り当てることで、配送費用が指定のG/L勘定に転記されるようになります。\n一方、検索順序や条件レコードでは勘定キーの割当は行われず、条件タイプ自体にも直接割り当てることはできません。",
        },
        
        # 問題 72
        {
            "question": "非在庫品目を定期購買しています。そうした場合に、特定の勘定が自動的に提案されるようにするには、何を設定する必要がありますか。",
            "choices": [
                "評価クラスを勘定設定カテゴリに割り当てる",
                "評価クラスを品目グループに割り当てる",
                "内部処理キーを品目グループに割り当てる",
                "内部処理キーを勘定設定カテゴリに割り当てる"
            ],
            "answer": "評価クラスを品目グループに割り当てる",
            "explanation": "品目マスタが存在しない非在庫品目の調達では、品目グループに評価クラスを割り当てることで、勘定設定を自動提案できます。\n購買管理のカスタマイジング「入力ヘルプ（品目マスタ未登録明細）」にて、品目グループと評価クラスの紐付けを行うことで、伝票入力時に適切な勘定が提案されます。",
        },

        # 問題 73
        {
            "question": "SAP S/4HANA システムに複数の会社コードとプラントがあります。プラントレベルに評価エリアを設定しています。勘定設定を設定する労力を軽減するには、どうすればよいですか。",
            "choices": [
                "評価グループコードを使用して、異なる勘定コード表を持つ会社コードに割り当てられたプラントをグループ化する",
                "評価グループコードを使用して、同じ勘定コード表を持つ会社コードに割り当てられたプラントをグループ化する",
                "勘定修正キーを使用して、同じ勘定コード表を持つ会社コードに割り当てられたプラントをグループ化する",
                "勘定修正キーを使用して、異なる勘定コード表を持つ会社コードに割り当てられたプラントをグループ化する"
            ],
            "answer": "評価グループコードを使用して、同じ勘定コード表を持つ会社コードに割り当てられたプラントをグループ化する",
            "explanation": "評価エリアがプラントレベルの場合、評価グループコードを使って同じ勘定コード表を持つプラントをまとめることで、勘定設定の重複を避け、設定作業を効率化できます。\nこのグループ化により、同一の勘定設定を複数プラントに一括適用可能になります。",
        },

        # 問題 74
        {
            "question": "製造指図への出庫および廃棄のための出庫の転記時に、さまざまな勘定を設定する必要があります。勘定設定で更新する必要がある割当は、以下のうちどれですか。",
            "choices": [
                "トランザクション WRX への勘定修正キー VBR の割当",
                "トランザクション GBB への勘定修正キー VBR の割当",
                "トランザクション GBB への勘定修正キー VNG の割当",
                "トランザクション BSX への勘定修正キー VNG の割当"
            ],
            "answer": [
                "トランザクション GBB への勘定修正キー VBR の割当",
                "トランザクション GBB への勘定修正キー VNG の割当"
            ],
            "explanation": "在庫転記における出庫や廃棄処理では、業務トランザクションGBBが使用され、勘定修正キーによって処理内容に応じた勘定が割り当てられます。\n製造指図への出庫にはVBR、廃棄にはVNGを割り当てることで、適切な消費・廃棄費用勘定に転記されます。",
        }
        
    ],
        
   "トピック 9: 購買管理の設定": [
        
        
        # 問題 75
        {
            "question": "出力決定において検索順序を使用して決定されるオブジェクトは、以下のうちどれですか。",
            "choices": [
                "出力条件レコードの出力デバイス",
                "伝票カテゴリの出力決定表",
                "出力タイプの出力条件レコード",
                "出力決定表の出力タイプ"
            ],
            "answer": "出力タイプの出力条件レコード",
            "explanation": "出力決定では、検索順序に従って出力タイプに対応する条件レコード（出力レコード）を検索します。\nこの検索により、伝票処理時に適切な出力形式や内容が自動的に決定されます。",
        },

        # 問題 76
        {
            "question": "プロジェクトにおいて、受託品購買発注で他の購買発注とは異なる番号範囲が利用されるようにする必要があります。どのようにする必要がありますか。",
            "choices": [
                "新しい伝票カテゴリをカスタマイズし、新しい番号範囲オブジェクトを割り当て、受託品の明細カテゴリをこのカテゴリにのみ割り当てる",
                "新しい伝票タイプをカスタマイズし、新しい番号範囲オブジェクトを割り当て、受託品の明細カテゴリをこのタイプにのみ割り当てる",
                "新しい伝票タイプをカスタマイズし、新しい番号範囲を割り当て、受託品の明細カテゴリをこのタイプにのみ割り当てる",
                "新しい伝票カテゴリをカスタマイズし、新しい番号範囲を割り当て、受託品の明細カテゴリをこのカテゴリにのみ割り当てる"
            ],
            "answer": "新しい伝票タイプをカスタマイズし、新しい番号範囲を割り当て、受託品の明細カテゴリをこのタイプにのみ割り当てる",
            "explanation": "受託品専用の購買発注番号範囲を使用するには、伝票タイプごとに番号範囲を割り当てる必要があります。\nそのため、受託品専用の伝票タイプを新規作成し、そこに専用番号範囲と明細カテゴリを割り当てることで、他の購買発注と区別された管理が可能になります。",
        },

        # 問題 77
        {
            "question": "以下のどの割当を設定できますか。（2つ選択）",
            "choices": [
                "伝票タイプごとに使用可能な勘定設定カテゴリ",
                "明細カテゴリごとに使用可能な勘定設定カテゴリ",
                "伝票タイプごとに使用可能な明細カテゴリ",
                "勘定設定カテゴリごとに使用可能な明細カテゴリ"
            ],
            "answer": [
                "明細カテゴリごとに使用可能な勘定設定カテゴリ",
                "伝票タイプごとに使用可能な明細カテゴリ"
            ],
            "explanation": "伝票タイプは「どの明細カテゴリを使えるか」を決める役割があります。また、明細カテゴリでは「どの勘定設定カテゴリを使えるか」を指定します。/nこれにより、購買伝票で入力できる内容を細かくコントロールできます。/n例えば、学校で“クラスごとに選べる科目が違う”ように、伝票タイプや明細カテゴリごとに選択肢が変わるイメージです。",
        },

        # 問題 78
        {
            "question": "購買において、使用する伝票タイプによって管理できるものは何ですか。（3つ選択）",
            "choices": [
                "使用可能明細カテゴリ",
                "使用可能勘定設定カテゴリ",
                "確認管理",
                "明細番号間隔",
                "番号範囲"
            ],
            "answer": [
                "使用可能明細カテゴリ",
                "明細番号間隔",
                "番号範囲"
            ],
            "explanation": "伝票タイプでは、番号範囲や明細番号の間隔、そして使用できる明細カテゴリなどを管理します。/nつまり、伝票タイプごとに「どんな形式で伝票を作るか」を決める設定です。/n例えば、会社で“部署ごとに使う書類のフォーマットが違う”ようなイメージです。",
        },

        # 問題 79
        {
            "question": "過去日付の納入日で購買発注を登録できるユーザを制限するには、何を設定する必要がありますか。",
            "choices": [
                "システムメッセージを新しいバージョンにコピーし、それを警告メッセージとして設定する。ユーザパラメータ MSV を含むバージョンを権限のないユーザに割り当てる。",
                "システムメッセージを新しいバージョンにコピーし、それをエラーメッセージとして設定する。ユーザパラメータ MSV を含むバージョンを権限のないユーザに割り当てる。",
                "システムメッセージを新しいバージョンにコピーし、それを警告メッセージとして設定する。ユーザパラメータ MSV を含むバージョンを権限のあるユーザに割り当てる。",
                "システムメッセージを新しいバージョンにコピーし、それをエラーメッセージとして設定する。ユーザパラメータ MSV を含むバージョンを権限のあるユーザに割り当てる。"
            ],
            "answer": "システムメッセージを新しいバージョンにコピーし、それをエラーメッセージとして設定する。ユーザパラメータ MSV を含むバージョンを権限のないユーザに割り当てる。",
            "explanation": "システムメッセージはバージョンごとに動作を変えられます。新しいバージョンを作り、その中でメッセージをエラーに変更し、権限のないユーザに割り当てることで登録を禁止できます。/n例えば、会社で“特定の人だけが重要な書類を提出できるようにロックをかける”ような仕組みです。",
        },

        # 問題 80
        {
            "question": "購買発注の価格条件が特定のユーザにのみ表示されるようにするには、何を設定する必要がありますか。",
            "choices": [
                "活動カテゴリの項目選択キー",
                "ユーザパラメータ EVO",
                "ユーザパラメータ EFB",
                "トランザクションの項目選択キー"
            ],
            "answer": "ユーザパラメータ EFB",
            "explanation": "ユーザパラメータ EFB を使うと、購買依頼や購買発注で表示できる機能をユーザごとに制限できます。/n価格条件の表示もこのパラメータで制御できます。/n例えば、アルバイトには売上データを見せず、社員だけが見られるようにするような“閲覧制限”のイメージです。",
        },

        # 問題 81
        {
            "question": "出力決定の条件テクニックを使用して変更内容を送信する場合、満たす必要がある前提条件はどれですか。（3つ選択）",
            "choices": [
                "変更メッセージ用新規出力決定区分がカスタマイズでフラグ設定されている。",
                "変更メッセージに関連するディスパッチ時間を1に設定する必要がある。",
                "条件レコードに価格および数量項目が含まれる。",
                "価格および数量項目が出力変更に関連するものである。",
                "新規印刷オプションと変更印刷オプションに対して異なる出力タイプを設定する。"
            ],
            "answer": [
                "変更メッセージ用新規出力決定区分がカスタマイズでフラグ設定されている。",
                "価格および数量項目が出力変更に関連するものである。",
                "新規印刷オプションと変更印刷オプションに対して異なる出力タイプを設定する。"
            ],
            "explanation": "変更通知を自動で送るには、変更出力用の区分を有効化し、変更に関係する項目（価格や数量）を設定し、新規と変更で別の出力タイプを使えるようにしておく必要があります。/n例えば、“初回の案内は郵送、変更連絡はメールで送る”といった使い分けができるイメージです。",
        },

        # 問題 82
        {
            "question": "購買管理のフレキシブルワークフローにおける明細別承認はどの伝票カテゴリで実行できますか。",
            "choices": [
                "購買発注",
                "見積依頼",
                "購買依頼",
                "分納契約"
            ],
            "answer": "購買依頼",
            "explanation": "フレキシブルワークフローは多くの伝票で使えますが、明細ごとに承認できるのは購買依頼だけです。/n例えば、“注文書全体ではなく、1つ1つの品目ごとに承認したい”という細かい管理ができるのが購買依頼だけというイメージです。",
        },

        # 問題 83
        {
            "question": "購買伝票承認の権限オブジェクト M_EINK_FRG に含まれる項目はどれですか。（2つ選択）",
            "choices": [
                "承認区分",
                "承認コード",
                "承認方針",
                "承認グループ"
            ],
            "answer": [
                "承認コード",
                "承認グループ"
            ],
            "explanation": "M_EINK_FRG では、どの承認コードを使えるか、どの承認グループに属するかを制御します。/nこれにより、誰がどの伝票を承認できるかを管理できます。/n例えば、“部長だけが高額の申請を承認できる”といった権限分けのイメージです。",
        },

        # 問題 84
        {
            "question": "購買発注承認のフレキシブルワークフローの前提条件はどれですか。（3つ選択）",
            "choices": [
                "購買発注のフレキシブルワークフローの特性を備えたクラスを登録する。",
                "カスタマイジングで購買発注の従来の承認手続を無効化する。",
                "SAP Fiori アプリでフレキシブルワークフローの前提条件を設定する。",
                "SAP Fiori アプリでフレキシブルワークフローの受信者を定義する。",
                "カスタマイジングでフレキシブルワークフローを有効化する。"
            ],
            "answer": [
                "SAP Fiori アプリでフレキシブルワークフローの前提条件を設定する。",
                "SAP Fiori アプリでフレキシブルワークフローの受信者を定義する。",
                "カスタマイジングでフレキシブルワークフローを有効化する。"
            ],
            "explanation": "フレキシブルワークフローを使うには、まずカスタマイジングで機能を有効化し、その後 Fiori アプリで前提条件や承認者（受信者）を設定します。/n例えば、“社内の承認フローをシステムに登録して、自動で回るようにする”ようなイメージです。",
        },
        
        # 問題 85
        {
            "question": "購買伝票に対する SAP S/4HANA 出力管理の有効化は、どのレベルで行いますか。",
            "choices": [
                "伝票タイプ",
                "アプリケーションオブジェクト",
                "購買組織",
                "伝票カテゴリ"
            ],
            "answer": "アプリケーションオブジェクト",
            "explanation": "SAP S/4HANA の出力管理を有効化するには、「アプリケーションオブジェクト」という単位で設定を行います。/nこれは、出力管理の対象となる伝票の種類（購買発注など）をまとめて管理するための仕組みです。/n例えば、“学校で通知表を出すかどうかを学年単位で決める”ように、出力管理も伝票の種類ごとに有効化するイメージです。/n設定はカスタマイジング画面の「出力管理 > 管理 > アプリケーションオブジェクトタイプの有効化」で行います。",
        }
 
    ],
   
    "トピック 10: 購買組織": [
        # 問題 86
        {
            "question": "プラントにおける品目の調達を完全にブロックするには、どうすればよいですか。（2つ選択）",
            "choices": [
                "品目マスタで該当するプラント固有品目ステータスを使用する。",
                "ブロック区分があり、仕入先がないエントリを供給元一覧で登録する。",
                "ゼロの数量で供給量割当エントリを登録する。",
                "仕入先マスタレコードでブロックエントリを登録する。"
            ],
            "answer": [
                "品目マスタで該当するプラント固有品目ステータスを使用する。",
                "ブロック区分があり、仕入先がないエントリを供給元一覧で登録する。"
            ],
            "explanation": "品目の調達を完全に止めたい場合は、2つの方法があります。/n1つ目は、品目マスタでプラントごとのステータスを「調達不可」に設定すること。これにより、そのプラントではその品目を発注できなくなります。/n2つ目は、供給元一覧に「ブロック区分付きで仕入先なし」のエントリを登録すること。これにより、システムはその品目に対して有効な供給元がないと判断し、調達を拒否します。/n例えば、“社内で特定の備品をもう使わないと決めた場合、その備品を注文できないように設定する”ようなイメージです。",
        },
        
        # 問題 87
        {
            "question": "供給量割当が有効な品目について、2,000個の不足がMRP実行で検出されました。2つの仕入先はそれぞれ、一度に1,000個しか供給できません。MRPによって仕入先ごとに1,000個の調達提案が生成されるようにするには、何を更新する必要がありますか。（2つ選択）",
            "choices": [
                "使用しているロットまとめ方式に分割量割当の区分を割り当てる。",
                "仕入先ごとの供給量割当明細で最大供給量割当数量を設定する。",
                "供給量割当明細で最大ロットサイズを設定し、1xチェックボックス（一度限り区分）を有効化する。",
                "計画品目の品目マスタレコードに丸めプロファイルを割り当てる。"
            ],
            "answer": [
                "使用しているロットまとめ方式に分割量割当の区分を割り当てる。",
                "供給量割当明細で最大ロットサイズを設定し、1xチェックボックス（一度限り区分）を有効化する。"
            ],
            "explanation": "MRP（資材所要量計画）で複数の仕入先に分けて発注したい場合、まずロットまとめ方式に「分割量割当」の区分を設定することで、所要量を複数の供給元に分けることができます。/nさらに、供給量割当明細で「最大ロットサイズ」を1,000個に設定し、「1x区分（1回限り）」を有効にすると、同じ仕入先に複数回発注されるのを防ぎ、他の仕入先にも割り当てられるようになります。/n例えば、イベントで2社からお弁当を調達する際、1社につき1,000個までしか頼めないなら、1,000個ずつ2社に分けて発注するように設定するイメージです。",
        },
        
        # 問題 88
        {
            "question": "原材料の調達を行う際に、購買依頼から購買発注への自動変換を使用する必要があります。そのための前提条件は何ですか。（3つ選択）",
            "choices": [
                "有効な条件を含む供給元が購買依頼に割り当てられている。",
                "取引先マスタレコードの購買データに、自動購買発注区分が設定されている。",
                "プラント固有の供給元一覧登録が品目に存在する。",
                "品目マスタレコードのプラント固有購買データに、自動購買発注区分が設定されている。",
                "プラント固有の条件を含む契約が品目および仕入先に存在する。"
            ],
            "answer": [
                "有効な条件を含む供給元が購買依頼に割り当てられている。",
                "取引先マスタレコードの購買データに、自動購買発注区分が設定されている。",
                "品目マスタレコードのプラント固有購買データに、自動購買発注区分が設定されている。"
            ],
            "explanation": "購買依頼を自動で購買発注に変換するには、いくつかの条件がそろっている必要があります。/nまず、品目マスタの購買データに「自動購買発注区分」が設定されていること。これにより、その品目は自動発注の対象になります。/n次に、仕入先マスタにも同じく「自動購買発注区分」が設定されている必要があります。/nさらに、購買依頼に有効な供給元（仕入先や契約など）が割り当てられていることで、システムはどこに発注すべきかを判断できます。/n例えば、社員が備品を申請したら、条件がそろっていれば自動で発注書が作られるような仕組みです。",
        },
        
        
        # 問題 89
        {
            "question": "購買部門では、期日超過購買発注を監視する必要があります。購買発注の納入督促状を発行するための前提条件は何ですか。（3つ選択）",
            "choices": [
                "購買発注明細の催促期間を更新する。",
                "仕入先マスタの確認管理キーを更新する。",
                "サプライヤに購買発注を送信する。",
                "出力決定を設定し、出力レコードを更新する。",
                "購買発注明細の購買許容値キーを更新する。"
            ],
            "answer": [
                "購買発注明細の催促期間を更新する。",
                "サプライヤに購買発注を送信する。",
                "出力決定を設定し、出力レコードを更新する。"
            ],
            "explanation": "納入が遅れている発注に対して督促状を出すには、いくつかの準備が必要です。/nまず、購買発注明細に「催促期間（何日遅れたら督促するか）」を設定しておく必要があります。/n次に、発注書がサプライヤに送信されていること。送っていないと督促の意味がありません。/nそして、督促状を出力するための「出力決定」と「出力レコード」が設定されていることが必要です。/n例えば、図書館で“返却期限を過ぎた本に対して自動で督促メールを送る”ような仕組みです。",
        },
        
        # 問題 90
        {
            "question": "割当済購買依頼を購買発注に一括変換する必要があります。これをどのように実行できますか。（3つ選択）",
            "choices": [
                "資材所要量計画（MRP）を実行する。",
                "購買発注の自動生成を実行する。",
                "供給元一覧を使用する。",
                "購買発注登録アプリの伝票概要を使用する（ME21N）。",
                "割当一覧を使用する。"
            ],
            "answer": [
                "購買発注の自動生成を実行する。",
                "購買発注登録アプリの伝票概要を使用する（ME21N）。",
                "割当一覧を使用する。"
            ],
            "explanation": "割当済の購買依頼をまとめて購買発注に変換するには、いくつかの方法があります。/nまず「割当一覧（ME58）」を使えば、複数の購買依頼を一括で発注に変換できます。/n次に「購買発注登録アプリ（ME21N）」の伝票概要を使うと、割当済の依頼をワークリストとして表示し、選択して発注できます。/nさらに「購買発注の自動生成（ME59N）」を使えば、バックグラウンドで自動的に発注処理を行うことも可能です。/n例えば、社内で“承認済の注文リストをまとめて業者に発注する”ような流れを自動化するイメージです。",
        },
        
        
        # 問題 91
        {
            "question": "状況処理ユースケース \"サプライヤの納入での数量不足\" を設定する場合に使用する必要がある SAP Fiori アプリは、以下のうちどれですか。（2つ選択）",
            "choices": [
                "状況タイプ管理",
                "チームおよび責任の管理",
                "状況監視",
                "状況オブジェクト管理"
            ],
            "answer": [
                "状況タイプ管理",
                "チームおよび責任の管理"
            ],
            "explanation": "SAP S/4HANA の状況処理では、特定の問題（例：納入数量不足）が発生したときに、関係者へ通知を送る仕組みを作ることができます。/nそのためには、まず「状況タイプ管理」アプリで通知の内容や条件を設定します。/n次に「チームおよび責任の管理」アプリで、誰に通知を送るか（担当者や部門）を定義します。/n例えば、“納品が足りないときに購買担当者へ自動でアラートを送る”ような仕組みを作るイメージです。",
        },
        
        # 問題 92
        {
            "question": "仕入先Aは、特定の品目の主要供給元として自動的に提案される必要があります。可能なオプションはどれですか。（2つ選択）",
            "choices": [
                "購買情報で通常仕入先区分を使用する。",
                "取引先マスタレコードで通常仕入先区分を設定する。",
                "品目マスタレコードに主要供給元として仕入先を入力する。",
                "供給元一覧を使用して仕入先を固定としてマークする。"
            ],
            "answer": [
                "購買情報で通常仕入先区分を使用する。",
                "供給元一覧を使用して仕入先を固定としてマークする。"
            ],
            "explanation": "特定の品目について、仕入先Aを優先的に使いたい場合は、2つの方法があります。/n1つ目は「購買情報」に通常仕入先区分を設定すること。これにより、その仕入先が標準として扱われ、供給元決定時に自動的に選ばれます。/n2つ目は「供給元一覧」で仕入先を固定としてマークすること。これにより、その仕入先が優先され、他の候補よりも先に選ばれます。/n例えば、“社内でいつも使っている文房具店を優先して注文するように設定する”ようなイメージです。",
        },
        
        
        # 問題 93
        {
            "question": "システムで利用可能な1つの品目に対して有効な購買情報が複数あります。購買依頼をマニュアルで登録する場合、システム動作はどうなりますか。",
            "choices": [
                "最新の購買情報が選択される。",
                "最新の購買発注から購買情報が選択される。",
                "有効な購買情報がすべて一覧表示され、ユーザはいずれかの購買情報を選択する必要がある。",
                "最低価格の購買情報が選択される。"
            ],
            "answer": "有効な購買情報がすべて一覧表示され、ユーザはいずれかの購買情報を選択する必要がある。",
            "explanation": "購買依頼を手動で登録する際、品目に対して複数の有効な購買情報がある場合は、システムがそれらを一覧表示してくれます。/nその中から、ユーザが適切なものを選ぶ必要があります。/n自動で最新や最安の情報が選ばれるわけではないため、状況に応じて判断することが重要です。/n例えば、“複数の業者から見積もりを取っていて、どれを使うかを自分で選ぶ”ようなイメージです。",
        },
        
        # 問題 94
        {
            "question": "以下のうち、確認管理キーを使用して管理できるものはどれですか。（2つ選択）",
            "choices": [
                "入庫の伝票タイプ",
                "確認が入庫の前提条件であるかどうか",
                "未処理の確認に対するデフォルトの催促レベル",
                "必要な確認の順序"
            ],
            "answer": [
                "確認が入庫の前提条件であるかどうか",
                "未処理の確認に対するデフォルトの催促レベル",
                "必要な確認の順序"
            ],
            "explanation": "確認管理キーは、仕入先から受け取る確認の種類や順番、そして確認が入庫の条件になるかどうかを管理するための設定です。/nまた、確認が遅れている場合に自動で催促するための「催促レベル」も定義できます。/n例えば、“納品前に出荷通知が必要”とか、“出荷通知が来なければ倉庫に入れない”といったルールを決めるイメージです。/nこのキーを使えば、確認の流れをシステム上でしっかり管理できます。",
        },
        
        # 問題 95
        {
            "question": "以下のうち、状況処理に状況テンプレートが存在するビジネスシナリオはどれですか。（2つ選択）",
            "choices": [
                "購買発注承認が保留中である。",
                "仕入先確認が保留中である。",
                "支払保留請求書の支払期日が過ぎている。",
                "契約が供給元として準備済である。"
            ],
            "answer": [
                "仕入先確認が保留中である。",
                "契約が供給元として準備済である。"
            ],
            "explanation": "SAP S/4HANA の状況処理では、特定の業務状況に応じて、関係者に通知を送るテンプレートが用意されています。/n「仕入先確認が保留中」のテンプレートでは、納品に関する確認がまだ完了していない場合に、購買担当者へ通知されます。/n「契約が供給元として準備済」のテンプレートでは、新しい契約が登録されたことを知らせ、購買依頼に活用できるよう促します。/n例えば、“納品予定が未確定のまま放置されている”や“新しい契約があるのに誰も使っていない”といった状況を自動で拾って知らせる仕組みです。",
        }
 
    ],
    
    "トピック 11: SAP S/4HANA のユーザエクスペリエンス": [
        
        # 問題 96
        {
            "question": "SAP Fiori ラウンチパッドと従来の SAP グラフィカルユーザインタフェース (SAP GUI) の違いは何ですか。",
            "choices": [
                "SAP Fiori ラウンチパッドはロールベースであるが、SAP GUI では多くのユーザーロールに対して単一の複合トランザクションが提供されることがよくある。",
                "SAP Fiori ラウンチパッドはパーソナライズできるが、SAP GUI はパーソナライズできない。",
                "SAP Fiori ラウンチパッドでは、お気に入りが更新されつつ、ファイルアクセスも可能だが、SAP GUI ではお気に入りが更新されるのみである。",
                "SAP Fiori ラウンチパッドではブラウザベースのトランザクションが有効化されるが、SAP GUI では有効化されない。"
            ],
            "answer": "SAP Fiori ラウンチパッドはロールベースであるが、SAP GUI では多くのユーザーロールに対して単一の複合トランザクションが提供されることがよくある。",
            "explanation": "SAP Fiori ラウンチパッドは、ユーザの役割（ロール）に応じて必要な機能だけを表示する設計になっています。/n一方、SAP GUI は複数の業務をまとめた複合トランザクションが多く、すべての機能が一画面に集約されていることがよくあります。/nFioriでは「必要なものだけを見せる」、GUIでは「全部まとめて見せる」という違いがあります。/n例えば、Fioriは“営業担当には見積作成だけを表示する”、GUIは“営業・在庫・請求など全部の機能が並んでいる”ようなイメージです。",
        },
       
        # 問題 97
        {
            "question": "SAP Fiori ラウンチパッドで使用可能なパーソナライゼーションのオプションは、以下のうちどれですか。（2つ選択）",
            "choices": [
                "新規カタログを追加する。",
                "既存のタイルグループにタイルを追加する。",
                "新規タイルグループを追加する。",
                "ビジネスロールタイルグループを追加する。"
            ],
            "answer": [
                "既存のタイルグループにタイルを追加する。",
                "新規タイルグループを追加する。"
            ],
            "explanation": "SAP Fiori ラウンチパッドでは、ユーザが自分の業務に合わせて画面をカスタマイズできます。/nたとえば「新規タイルグループを追加する」ことで、自分専用の作業カテゴリを作ることができます。/nまた「既存のタイルグループにタイルを追加する」ことで、よく使う機能をまとめて表示できます。/n例えば、“スマホのホーム画面にアプリを並べ替える”ような感覚で、自分の業務に合った画面を作れるイメージです。",
        },
        
        # 問題 98
        {
            "question": "ホームページのパーソナライズ機能はどこで有効化しますか。",
            "choices": [
                "ユーザに割り当てられたビジネスロール",
                "バックエンドシステムのユーザ設定",
                "SAP Fiori ラウンチパッドの設定",
                "ビジネスカタログ"
            ],
            "answer": "SAP Fiori ラウンチパッドの設定",
            "explanation": "SAP Fiori ラウンチパッドでは、ユーザが自分の業務に合わせて画面をパーソナライズできるように設定が用意されています。/nこの機能はラウンチパッドの設定画面から有効化することで使えるようになります。/nたとえば、テーマカラーの変更や、表示するタイルグループの選択、言語や地域の設定などが可能です。/nスマホのホーム画面を自分好みに並べ替えるような感覚で、業務に必要な情報だけを見やすく整えることができます。",
        },
        
        # 問題 99
        {
            "question": "SAP Fiori アプリにはどのようなタイプがありますか。（3つ選択）",
            "choices": [
                "分析",
                "対話型",
                "ファクトシート",
                "トランザクション",
                "KPI レポート"
            ],
            "answer": [
                "分析",
                "ファクトシート",
                "トランザクション"
            ],
            "explanation": "SAP Fiori アプリは、目的や機能に応じて3つのタイプに分類されます。/n「トランザクションアプリ」は、従来の業務処理（発注や登録など）を行うための画面です。/n「分析アプリ」は、データをグラフや表で可視化し、業務の傾向や問題点を把握するために使います。/n「ファクトシートアプリ」は、検索結果や詳細情報を表示するための画面で、関連情報をすばやく確認できます。/n例えば、“トランザクションは作業する画面”、“分析は考えるための画面”、“ファクトシートは調べるための画面”というイメージです。",
        },

        # 問題 100
        {
            "question": "SAP Fiori では、ロールベースの設計原則がどのように実現されますか。（2つ選択）",
            "choices": [
                "ニーズに合わせて調整できる SAP Fiori アプリを定義する。",
                "大きなトランザクションを、ユーザのロールに適した複数の個別アプリに分解する。",
                "エンドユーザの作業にまさに必要なものを提供する。",
                "トランザクションアプリと分析アプリを異なるビジネスロールに分類する。"
            ],
            "answer": [
                "大きなトランザクションを、ユーザのロールに適した複数の個別アプリに分解する。",
                "エンドユーザの作業にまさに必要なものを提供する。"
            ],
            "explanation": "SAP Fiori のロールベース設計では、ユーザが日々の業務で本当に必要な機能だけを使えるように画面が構成されます。/n従来のSAP GUIでは、1つの画面に多くの機能が詰め込まれていましたが、Fioriではそれを分解して、役割ごとに必要なアプリだけを表示します。/n例えば、“営業担当には見積作成と受注確認だけを表示し、在庫管理や会計は非表示にする”といった形で、業務に集中できるように設計されています。",
        }
    ],
    
          
    "トピック 12: 苦手問題たち": [
        
       # 問題 89	
       {   "question_number": 89,	
           "question": "任意のデータベース上で実行できるSAP Fiori アプリはどれですか。(2つ選択)",	
           "choices": ["銀行振込実行" ,	
                       "勘定コード表管理" ,	
                       "債務概要" ,	
                       "得意先会計伝票",],	
           "answer": ["銀行振込実行" ,"勘定コード表管理" ],	
           "explanation":"◆ SAP Fiori アプリの種類と特徴\n\n- トランザクションアプリ\n → ABAP を使って従来型の業務機能を提供。\n→ 任意のデータベース上で実行可能。\n例：銀行振込実行 (Make Bank Transfers)、勘定コード表管理 (Manage Chart of Accounts)\n\n- 分析アプリ\n → SAP HANA の分析機能を利用してデータに基づく洞察を提供。\n→ SAP HANA データベース上で実行。\n例：債務概要 (Accounts Payable Overview)\n\n- ファクトシートアプリ\n → SAP HANA のエンタープライズサーチ機能で検索結果を提供。\n→ SAP HANA データベース上で実行。\n例：得意先会計伝票 (Customer Accounting Document)\n\n◆ ポイント\n- SAP Fiori アプリは、トランザクション・分析・ファクトシートの3タイプに分類される。\n\n・任意のデータベースで動かせるのはトランザクションアプリだけ\n。・分析や検索系アプリは SAP HANA 専用で高速処理やインサイト提供が可能。",	
       },       
    ],    
}
# ===== トップページ =====
@app.route('/')
def index():
    topics = list(quiz_data.keys())
    progress = session.get("index", 0)
    total = session.get("total", 0)
    return render_template('index.html', topics=topics, progress=progress, total=total)

# ===== クイズ開始 =====
@app.route('/start', methods=['POST'])
def start():
    selected_topics = request.form.getlist('topics')
    shuffle_questions = 'shuffle_questions' in request.form
    shuffle_choices = 'shuffle' in request.form

    if not selected_topics:
        return render_template(
            'index.html',
            topics=list(quiz_data.keys()),
            error="少なくとも1つ選択してください"
        )


    # 複数トピックの問題をまとめる
    questions = []
    for topic in selected_topics:
        if topic in quiz_data:
            for i, q in enumerate(quiz_data[topic]):
                questions.append((topic, i))
                
                
 # 問題シャッフル
    if shuffle_questions:
        random.shuffle(questions)

    session['selected_topics'] = selected_topics
    session['index'] = 0
    session['score'] = 0
    session['questions'] = questions
    session['shuffle_choices'] = shuffle_choices

    return redirect(url_for('quiz'))

# ===== 共通関数: 選択トピックの問題取得 =====
def get_selected_questions():
    selected_topics = session.get('selected_topics', [])
    questions = []
    for topic in selected_topics:
        questions.extend(quiz_data.get(topic, []))
    if session.get("shuffle_questions", False):
        random.shuffle(questions)
    return questions

# ===== 問題表示 =====
@app.route('/quiz')
def quiz():
    index = session.get("index", 0)
    questions = session.get("questions", [])
    total = len(questions)
    session['total'] = total  # トータル数を保存

    if total == 0 or index >= total:
        return redirect(url_for('final_result'))

    topic, q_index = questions[index]   # ← tuple を展開
    question = quiz_data[topic][q_index]
    
    choices = question["choices"][:]
    if session.get("shuffle_choices", True):
        random.shuffle(choices)

    # 出題時の choices を保存
    session['current_choices'] = choices

    is_multiple = isinstance(question["answer"], list)

    return render_template(
        'quiz.html',
        question=question,
        choices=choices,
        is_multiple=is_multiple,
        current=index + 1,
        total=total
    )

# ===== 回答チェック =====
@app.route('/check', methods=['POST'])
def check():
    index = session.get("index", 0)
    questions = session.get("questions", [])
    total = len(questions)

    if total == 0 or index >= total:
        return redirect(url_for('final_result'))
    
    topic, q_index = questions[index]
    question = quiz_data[topic][q_index]
    
    selected = request.form.getlist('choice')
    correct_answer = question["answer"]
    
    if isinstance(correct_answer, list):
        is_correct = set(selected) == set(correct_answer)
    else:
        is_correct = selected == [correct_answer]
        
    # ===== 正誤をセッションに保存 =====
    answered = session.get("answered_questions", {})
    key = f"{topic}|{q_index}"  
    answered[key] = is_correct
    session["answered_questions"] = answered
    
    
    # 全体スコア更新
    if is_correct:
        session["score"] = session.get("score", 0) + 1

    # 出題時の choices を再利用
    choices = session.get("current_choices", question["choices"])

    return render_template(
        'result.html',
        is_correct=is_correct,
        selected=selected,
        answer=correct_answer,
        question=question,
        choices=choices
    )
        
# ===== 次の問題へ =====
@app.route('/next')
def next_question():
    index = session.get("index", 0) + 1
    questions = session.get("questions", [])
    total = len(questions)

    if index >= total:
        return redirect(url_for('final_result'))

    session["index"] = index
    return redirect(url_for('quiz'))

# ===== 最終結果 =====
@app.route('/final_result')
def final_result():
    score = session.get("score", 0)
    total = session.get("total", 0)
    
    # 過去の回答をセッションから取得
    answered = session.get("answered_questions", {})  # {(topic, q_index): True/False}
    
    # 全問題リストをセッションから取得
    questions = session.get("questions", [])

    # トピック別集計
    topic_scores = {}
    for topic, q_index in questions:
        if topic not in topic_scores:
             topic_scores[topic] = {"correct": 0, "incorrect": 0}
    
        key = f"{topic}|{q_index}"
        is_correct = answered.get(key, False)  # True / False / None
    
        if is_correct:
            topic_scores[topic]["correct"] += 1
        else:
            # 不正解 or 未回答も不正解扱い
            topic_scores[topic]["incorrect"] += 1
            
    return render_template(
        'final_result.html',
        score=score,
        total=total,
        topic_scores=topic_scores
    )
    
# ===== 中断 =====
@app.route('/abort', methods=['POST'])
def abort():
    return redirect(url_for('final_result'))

if __name__ == "__main__":
    app.run(debug=True)